jstackClass=function(){this.config={templatesPath:"view-js/",controllersPath:"controller-js/",defaultController:{},debug:$js.dev},this.controllers={}},jstackClass.prototype.extend=function(a,b){a.prototype=Object.create(b.prototype)},jstack=new jstackClass,function(){var a=function(b,c){let d=b.object,e=b.callback,f=b.recursive,g=b.key,h=b.namespace,i=b.enableAddObserver;c||(c=d);let j="__JSTACK__OBSERVABLE__";h&&(j+=h);let k;e&&(k={key:g,callback:e});let l=d[j];if(l)return k&&l.push(k),d;l=[],k&&l.push(k),f&&$.each(d,function(c,e){"object"==typeof e&&null!==e&&(d[c]=a($.extend({},b,{object:e}),d))});let m=function(a,b,c,d){let e={type:a,target:c,rootObject:d};"set"==a?(e.key=b.key,e.value=b.value):"unset"==a&&(e.key=b);for(let f=0,h=l.length;f<h;f++){let a=l[f];g&&g!==a.key||a.callback(e)}},n=function(a,b){"string"==typeof a&&(a=[a]);for(let c=0,d=a.length;c<d;c++)l.push({key:a[c],callback:b})};return new Proxy(d,{get:function(a,b){return i&&"addObserver"==b?n:b===j?l:a[b]},set:function(d,e,g){f&&"object"==typeof g&&null!==g&&(g=a($.extend({},b,{object:g}),c)),Array.isArray(d)?d.splice(e,0,g):d[e]=g,m("set",{key:e,value:g},d,c)},deleteProperty:function(a,b){return Array.isArray(a)?a.splice(b,1):delete a[b],m("unset",b,a,c),!0},ownKeys:function(a){return Reflect.ownKeys(a)}})};jstack.observe=function(){let b;if(1==arguments.length)b=arguments[0];else{b={},b.object=arguments[0];let e=arguments[1];if("object"==typeof e&&e instanceof Array){b.callback=arguments[2],b.recursive=arguments[3],b.namespace=arguments[4];for(var c=0,d=e.length;c<d;c++)a($.extend({},b,{key:e[c]}));return}"function"==typeof e&&(b.callback=e,b.recursive=arguments[2],b.namespace=arguments[3])}return a(b)},jstack.observable=function(b){return a({object:b,enableAddObserver:!0})};let b=function(a){let b="__JSTACK__OBSERVABLE__";a.namespace&&(b+=a.namespace);let c=a.object[b];if(c){let b=a.callback,d=a.key;if(d||b)for(let e=0,f=c.length;e<f;e++){let a=c[e];d&&d!==a.key||b&&b!==a.callback||c.splice(e,1)}else c.length=0}};jstack.unObserve=function(){let a;if(1==arguments.length)a=arguments[0];else{a={},a.object=arguments[0];let b=arguments[1];"string"==typeof b&&(b=[b]),"object"==typeof b&&b instanceof Array?(a.key=b,a.callback=arguments[2],a.namespace=arguments[3]):"function"==typeof b&&(a.callback=b,a.namespace=arguments[2])}return b(a)}}(),function(){var a=function(a,b,c){var d=this,e=b.data("jModel")||{};if(b[0].hasAttribute("j-view-inherit")){var f=b.parent().closest("[j-controller]");if(f.length&&b[0].hasAttribute("j-view-inherit")){var g=b[0].getAttribute("j-view-inherit"),h=f.data("jModel")||{};g?e[g]=h:e=$.extend({},h,e)}}var i={domReady:function(){},setData:function(){}};$.extend(!0,this,i,a),this.element=b,this.hash=c,this.data=e,b.data("jController",this),this.startDataObserver=function(){d.data;d.data=jstack.observe(d.data,function(a){jstack.dataBinder.update()},!0,"jstack.model")},this.setDataArguments=[],this.setDataCall=function(){var a=this.setData.apply(this,this.setDataArguments);0==a?this.noRender=!0:"object"==$.type(a)&&a!==ctrl.data&&$.extend(this.data,a),this.startDataObserver()},this.render=function(a){if(!this.noRender){var b=this.element;b.data("jModel",this.data),b[0].setAttribute("j-controller",this.name),Boolean(b[0].getAttribute("j-view-append"))?b.append(a):b.html(a);var c=$.Deferred();return jstack.ready(function(){d.domReady(),c.resolve()}),c}}};jstack.controller=function(b,c,d){if("object"==typeof b){if(b.extend){b.dependencies||(b.dependencies=[]);var e=$.Deferred();b.dependencies.push(e);var f=jstack.config.controllersPath+b.extend;$js.require(f),$js(f,function(){$.each(jstack.controllers[b.extend],function(a,c){switch(a){case"dependencies":c instanceof Array&&c.forEach(function(a){b.dependencies.push(a)});break;default:void 0===b[a]&&(b[a]=c)}}),e.resolve()})}if(b.mixins)for(var g=0,h=mixins.length;g<h;g++)$.each(mixins[g],function(a,c){void 0===b[a]&&(b[a]=c)});return jstack.controllers[b.name]=b,jstack.controllers[b.name]}if(!d){var i=c.parent().closest("[j-controller]");i.length&&(d=i.data("jController").hash),d||(d=window.location.hash)}var j=jstack.controllers[b]||jstack.controller($.extend(!0,{name:b},jstack.config.defaultController)),k=(j.name,$.Deferred()),l=[];if(j.dependencies&&j.dependencies.length){var m=$.Deferred();$js(j.dependencies,function(){m.resolve()}),l.push(m)}return $.when.apply($,l).then(function(){var b=new a(j,c,d),e=[],f=b.dependenciesData;if(f&&("function"==typeof f&&(b.dependenciesData=f=b.dependenciesData()),f&&f.length)){for(var g=[],h=0,i=f.length;h<i;h++){var l=f[h];if("function"==typeof l&&(l=l.call(b)),"object"==$.type(l)&&"abort"in l){var m=l;l=$.Deferred(),function(a){m.then(function(b){a.resolve(b)})}(l)}if(!("object"==$.type(l)&&"then"in l)){var m=l;l=$.Deferred(),l.resolve(m)}g.push(l)}var n=$.when.apply($,g).then(function(){for(var a=0,c=arguments.length;a<c;a++)b.setDataArguments.push(arguments[a])});e.push(n)}$.when.apply($,e).then(function(){b.setDataCall(),k.resolve(b)})}),k.promise()}}(),jstack.url=function(){var Url=function(){},recursiveArrayToObject=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(a[c]instanceof Array?b[c]=recursiveArrayToObject(a[c]):b[c]=a[c]);return b};return Url.prototype.params=new Array,Url.prototype.getQuery=function(a){var b=a,c=b.indexOf("?");return c==-1?"":(b=b.substr(c+1,b.length),c=b.indexOf("#"),c==-1?b:b.substr(0,c))},Url.prototype.getPath=function(a){var b=a.indexOf("?");return b==-1?a:a.substr(0,b)},Url.prototype.buildParamFromString=function(param){var p=decodeURIComponent(param),strpos=p.indexOf("=");if(strpos==-1)return""!==p&&(this.params[p]="",this.params.length++),!0;var name=p.substr(0,strpos),value=p.substr(strpos+1,p.length),openBracket=name.indexOf("["),closeBracket=name.indexOf("]");if(openBracket==-1||closeBracket==-1)return openBracket==-1&&closeBracket==-1||(name=name.replace(new RegExp("[\\[\\]]"),"_")),this.params[name]=value,!0;var matches=name.match(new RegExp("\\[.*?\\]","g"));name=name.substr(0,openBracket),p="this.params";var key=name;for(var i in matches)matches.hasOwnProperty(i)&&(p+="['"+key+"']",void 0!=eval(p)&&"object"==typeof eval(p)||eval(p+"= new Array();"),""==(key=matches[i].substr(1,matches[i].length-2))&&(key=eval(p).length));p+="['"+key+"']",eval(p+"= '"+value+"';")},Url.prototype.parseQuery=function(a){var b=a;b=b.replace(new RegExp("&"),"&"),this.params=new Array,this.params.length=0,b=b.split("&");for(var c=0;c<b.length;c++)this.buildParamFromString(b[c]);return recursiveArrayToObject(this.params)},Url.prototype.buildStringFromParam=function(a,b){var c="",d="";if(void 0!=b&&(c=b),"object"==typeof a)for(var e in a)d=a[e],e=""==c?e:"["+e+"]","object"==typeof d?this.buildStringFromParam(d,c+e):this.params[this.params.length]=c+e+"="+d},Url.prototype.buildQuery=function(a){return this.params=new Array,this.buildStringFromParam(a),this.params.join("&")},Url.prototype.getParams=function(a){return this.parseQuery(this.getQuery(a))},Url.prototype.getParamsFromHash=function(){return this.getParams(document.location.hash)},new Url}(),jstack.uniqid=function(a,b){void 0===a&&(a="");var c,d=function(a,b){return a=parseInt(a,10).toString(16),b<a.length?a.slice(a.length-b):b>a.length?Array(b-a.length+1).join("0")+a:a};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,c=a,c+=d(parseInt((new Date).getTime()/1e3,10),8),c+=d(this.php_js.uniqidSeed,5),b&&(c+=(10*Math.random()).toFixed(8).toString()),c},jstack.isPositiveInteger=function(a){return 0==a%(!isNaN(parseFloat(a))&&0<=~~a)},jstack.isIntKey=function(a){return a>>>0===parseFloat(a)},jstack.arrayRemove=function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=b<0?a.length+b:b,Array.prototype.push.apply(a,d)},jstack.flatObservable=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];d=JSON.parse(JSON.stringify(d)),a.push(d)}return a},jstack.log=function(){console.log((new Error).stack.split("\n")[1]);var a=jstack.flatObservable.apply(jstack,arguments);console.log.apply(console,a)},jstack.randomColor=function(){return"#"+Math.random().toString(16).substr(2,6)},jstack.fragmentToHTML=function(a){var b=document.createElement("div");return b.appendChild(document.importNode(a.content,!0)),b.innerHTML},function(){var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;jstack.isMobile=function(b){return b||(b=navigator.userAgent),a.test()}}(),String.prototype.camelCase=function(){return this.replace(/(\_[a-z])/g,function(a){return a.toUpperCase().replace("_","")})},String.prototype.camelCaseDash=function(){return this.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})},String.prototype.lcfirst=function(){return this.charAt(0).toLowerCase()+this.substr(1)},String.prototype.escapeRegExp=function(){return this.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},String.prototype.replaceAllRegExp=function(a,b){return this.replace(new RegExp(a,"g"),b)},String.prototype.replaceAll=function(a,b){return a=a.escapeRegExp(),this.replaceAllRegExp(a,b)},String.prototype.snakeCase=function(){return this.replace(/([A-Z])/g,function(a){return"_"+a.toLowerCase()})},String.prototype.snakeCaseDash=function(){return this.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},function(){function a(a,b){var c=[" ","\n","\r","\t","\f","\v"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join(""),d=0,e=0;for(a+="",b&&(c=(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1")),d=a.length,e=0;e<d;e++)if(c.indexOf(a.charAt(e))===-1){a=a.substring(e);break}for(d=a.length,e=d-1;e>=0;e--)if(c.indexOf(a.charAt(e))===-1){a=a.substring(0,e+1);break}return c.indexOf(a.charAt(0))===-1?a:""}function b(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1"):" \\s ";var c=new RegExp("^["+b+"]+","g");return(a+"").replace(c,"")}function c(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"\\$1"):" \\s ";var c=new RegExp("["+b+"]+$","g");return(a+"").replace(c,"")}String.prototype.trim=function(b){return a(this,b)},String.prototype.ltrim=function(a){return b(this,a)},String.prototype.rtrim=function(a){return c(this,a)}}(),String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.substr(1)},jstack.reflection={},jstack.reflection.arguments=function(f){var args=f.toString().match(/^\s*function\s+(?:\w*\s*)?\((.*?)\)\s*{/),r={};if(args&&args[1]){args=args[1],args=args.replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),args=args.trim().split(/\s*,\s*/);for(var i=0;i<args.length;i++){var arg=args[i],idf=arg.indexOf("=");idf===-1?r[arg]=void 0:r[arg.substr(0,idf)]=eval(arg.substr(idf+1).trim())}}return r},jstack.reflection.isCyclic=function(a){function b(a,g){if("object"==typeof a){if(e.has(a)){var h=d.indexOf(a),i=c.join(".")+"."+g,j=c.slice(0,h+1).join(".");return console.log("CIRCULAR: "+i+" = "+j+" = "+a),console.log(a),void(f=!0)}c.push(g),d.push(a),e.add(a);for(var k in a)a.hasOwnProperty(k)&&b(a[k],k);c.pop(),d.pop(),e.delete(a)}}var c=[],d=[],e=new Set,f=!1;return b(a,"obj"),f},jstack.traverseDomBreak={DESC:2,ASC:4,ADJ:8,BOTH:6,ALL:14},jstack.traverseDom=function(a,b,c){var d;if(c||(d=b(a)),c||!(d&jstack.traverseDomBreak.DESC))for(var e=a.childNodes,f=0;f<e.length;f++)if(e[f]){var g=this.traverseDom(e[f],b);if(g&jstack.traverseDomBreak.ASC&&(d|=g),g&jstack.traverseDomBreak.ADJ)break}return!c||d&jstack.traverseDomBreak.ASC||(d=b(a)),d},jstack.walkTheDOM=function(a,b){if(b(a)!==!1)for(var c=a.childNodes,d=0;d<c.length;d++)c[d]&&this.walkTheDOM(c[d],b)},$.arrayCompare=function(a,b){return 0===$(a).not(b).get().length&&0===$(b).not(a).get().length},$.fn.attrStartsWith=function(a){var b={};return this.each(function(c){$.each(this.attributes,function(c,d){0===d.name.indexOf(a)&&(b[d.name]=d.value)})}),b},$.attrsToObject=function(a,b,c){c||(c={});var d=a.split("--");void 0===c&&(c={});var e=c,f=d.length-1;return $.each(d,function(a,c){c=$.camelCase(c),a==f?e[c]=b:(e[c]||(e[c]={}),e=e[c])}),c},$.fn.changeVal=function(a){return $(this).val(a).trigger("change")},$.fn.childrenHeight=function(a,b,c){var d=bottomOffset=0;void 0===a&&(a=!0),void 0===b&&(b=!0),void 0===c&&(c=!0);var e=this.children();return c&&(e=e.filter(":visible")),e.each(function(c,e){var f=$(e),g=f.offset().top,h=g+(a?f.outerHeight(b):f.height());g<d&&(d=g),h>bottomOffset&&(bottomOffset=h)}),bottomOffset-d-this.offset().top},$.fn.dataAttrConfig=function(a){a||(a="data-");var b=a.length,c=this.attrStartsWith(a),d={};return $.each(c,function(a,c){$.attrsToObject(a.substr(b),c,d)}),d},$.fn.findExclude=function(a,b,c){var d=$([]);return $(this).each(function(e,f){$(f).find(a).each(function(a,e){var g=$(e);c&&(g=g.parent());var h=g.closest(b);h[0]!=f&&h.length||(d=d.add(e))})}),d},$.fn.hasHorizontalScrollBar=function(){return!!this.get(0)&&this.get(0).scrollWidth>this.innerWidth()},$.fn.hasVerticalScrollBar=function(){return!!this.get(0)&&this.get(0).scrollHeight>this.innerHeight()},function(){var a={"nth-level":function(a,b){b=parseInt(b,10);var c=[],d=this;return this.each(function(){$(this).parents(a).length;d.find(a).each(function(){$(this).parents(a).length==b-1&&c.push(this)})}),$(c)}};$.fn.findOrig=$.fn.find,$.fn.find=function(b){if("string"==typeof b){var c,d=this;if($.each(a,function(e,f){var g=b.indexOf(":"+e);if(g!==-1){var h=e.length,i=b.substr(0,g),j=b.substr(g+h+2,b.length-g-h-3);return c=a[e].call(d,i,j),!1}}),c)return c}return this.findOrig(b)}}(),$.on=function(a,b,c){return $(document).on(a,b,c)},$.off=function(a,b,c){return $(document).off(a,b,c)},$.one=function(a,b,c){return $(document).one(a,b,c)},$.extend($.expr[":"],{scrollable:function(a){return"scroll"==$(a).css("overflow")||"scroll"==$(a).css("overflowX")||"scroll"==$(a).css("overflowY")||(a.clientHeight<a.scrollHeight&&($.inArray($(a).css("overflowY"),["scroll","auto"])!=-1||$.inArray($(a).css("overflow"),["scroll","auto"])!=-1)||a.clientWidth<a.scrollWidth&&($.inArray($(a).css("overflowX"),["scroll","auto"])!=-1||$.inArray($(a).css("overflow"),["scroll","auto"])!=-1))},parents:function(a,b,c){return $(a).parents(c[3]).length<1},attrStartsWith:function(a,b,c){for(var d=0,e=a.attributes,f=e.length;d<f;d++)if(0===e[d].nodeName.toLowerCase().indexOf(c[3].toLowerCase()))return!0;return!1},attrEndsWith:function(a,b,c){for(var d=0,e=a.attributes,f=e.length;d<f;d++){var g=e[d].nodeName.toLowerCase(),h=c[3].toLowerCase();if(g.length>=h.length&&g.substr(g.length-h.length)===h)return!0}return!1},data:function(a,b,c){return!!$.data(a,c[3])}}),$.fn.removeClassPrefix=function(a){return this.each(function(b,c){var d=c.className.split(" ").filter(function(b){return 0!==b.lastIndexOf(a,0)});c.className=$.trim(d.join(" "))}),this},$.fn.requiredId=function(){if(this.length>1)return this.each(function(){$(this).requiredId()});var a=this[0].id;return a||(a=jstack.uniqid("uid-"),this[0].setAttribute("id",a)),a},$.fn.reverse=function(){return $(this.get().reverse())},$.fn.setVal=$.fn.val,$.fn.val=function(){var a=$.fn.setVal.apply(this,arguments);return arguments.length&&this.trigger("val"),a},function(){var a=function(a,b,c){var d=a.hasClass("select2-hidden-accessible");if(!a[0].hasAttribute("data-preselect")||d){if(d){var e;if(e=c.preventValEvent?function(a,b){a.setVal(b)}:function(a,b){a.val(b)},c.push){var f=a.val();null===f&&(f=[]),"object"!=typeof f&&(f=[f]),f.indexOf(b)===-1&&f.push(b),e(a,b)}else e(a,b);return void(c.preventValEvent||a.trigger("change"))}var g=!1,h="option";if(a.children().each(function(a){var d=$(this);"option"==this.tagName.toLowerCase()?d.val()==b?(d.prop("selected",!0),g=!0):c.push||d.prop("selected",!1):(0==a&&(h=d[0].tagName.toLowerCase()),d[0].getAttribute("value")==b?(d[0].setAttribute("selected","selected"),g=!0):c.push||d[0].removeAttribute("selected"))}),!g&&c.addMissing&&void 0!==b&&null!==b){var i,j;"object"==$.type(b)?(i=b.value,j=b.text):i=b,void 0===j&&(j=i),i||(i=j),a.append("<"+h+' value="'+i+'" selected="selected">'+j+"</"+h+">")}}else if(c.push){var f=a.data("preselect")||[];"object"!=typeof f&&(f=[f]),f.indexOf(b)===-1&&f.push(b),a.data("preselect",f)}else a.data("preselect",b)};$.fn.populateInput=function(b,c){void 0!==b&&null!==b||(b=""),c=$.extend({addMissing:this[0].hasAttribute("j-add-missing"),preventValEvent:!1,push:!1},c);var d;return d=c.preventValEvent?function(a,b){a.setVal(b)}:function(a,b){a.val(b)},this.each(function(){var e=$(this);if(!e.data("j:populate:prevent")){var f=this.tagName.toLowerCase();if("select"==f||"j-select"==f)if(b instanceof Array)if("[]"==this.getAttribute("name").substr(-2)||this.hasAttribute("multiple"))a(e,b,c);else for(var g=0,h=b.length;g<h;g++)a(e,b[g],c);else a(e,b,c);else if("textarea"==e[0].tagName.toLowerCase())d(e,b);else switch(e[0].getAttribute("type")){case"file":return;default:case"number":case"range":case"email":case"data":case"text":case"hidden":d(e,b);break;case"radio":e.length&&e.each(function(){$(this).prop("checked",this.value==b)});break;case"checkbox":e.length>1?$.each(e,function(a){for(var d,e=this.value,f=void 0,g=0;g<b.length;g++)(d=b[g])===e&&(f=d);f?$(this).prop("checked",!0):c.push||$(this).prop("checked",!1)}):1==e.length&&(b?e.prop("checked",!0):e.prop("checked",!1))}}})},$.fn.populateForm=function(a,b){b=$.extend({not:!1,notContainer:!1},b);var c=this,d=function(a,d){null===d&&(d="");var e=c.find(':input[name="'+a+'"]');b.addMissing&&!e.length&&c.append('<input type="hidden" name="'+a+'" value="'+d+'">'),e.each(function(){var a=$(this);b.not&&a.is(b.not)||b.notContainer&&a.closest(b.notContainer).length||a.populateInput(d,b)})},e=function(a,d){c.find(':input[name="'+a+'"],:input[name="'+a+'[]"]').each(function(){var a=$(this);b.not&&a.is(b.not)||b.notContainer&&a.closest(b.notContainer).length||a.populateInput(d,b)})},f=function(a,b){e(a,b),$.each(b,function(b,c){var e=a+"["+b+"]";"object"==typeof c&&null!=c?f(e,c):d(e,c)})};return $.each(a,function(a,b){"object"==typeof b&&null!=b?f(a,b):d(a,b)}),this},$.fn.populate=function(a,b){return this.each(function(){"form"==this.tagName.toLowerCase()?$(this).populateForm(a,b):$(this).populateInput(a,b)})},$.fn.populateReset=function(){return this.each(function(){if("form"==this.tagName.toLowerCase())$(this).find(":input[name]").populateReset();else{var a=$(this),b=a.prop("type");"checkbox"==b||"radio"==b?a.prop("checked",this.defaultChecked):a.populateInput(this.defaultValue,{preventValEvent:!0}),a.trigger("input")}})}}(),$.fn.outerHTML=function(){if(this.length){var a=$('<tmpl style="display:none;"></tmpl>'),b=($(this[0].cloneNode(!1)).html(this.html()).appendTo(a),a.html());return a.remove(),b}return null},$.fn.hasAttr=function(a){return this[0].hasAttribute(a)},$.fn.jComponentReady=function(a){var b=this,c=$.Deferred();a&&c.then(function(){b.each(function(){a.call(this)})});var d=function(){var a=!0;b.each(function(){if(!$(this).data("j.component.loaded"))return a=!1,!1}),a&&c.resolve()};return this.on("j:component:loaded",function(){d()}),d(),c.promise()};var rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i,rcheckableType=/^(?:checkbox|radio)$/i;jQuery.fn.serializeArrayWithEmpty=function(){return this.map(function(){var a=jQuery.prop(this,"elements");return a?jQuery.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(a)&&(this.checked||!rcheckableType.test(a))}).map(function(a,b){var c=jQuery(this).val();return null==c&&(c=""),jQuery.isArray(c)?jQuery.map(c,function(a){return{name:b.name,value:a.replace(rCRLF,"\r\n")}}):{name:b.name,value:c.replace(rCRLF,"\r\n")}}).get()},function(a,b){if("function"==typeof define&&define.amd)define(["exports","jquery"],function(a,c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("jquery");b(exports,c)}else b(a,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(a,b){function c(a,c){function e(a,b,c){return a[b]=c,a}function f(a,b){for(var c,f=a.match(d.key);void 0!==(c=f.pop());)if(d.push.test(c)){var h=g(a.replace(/\[\]$/,""));b=e([],h,b)}else 0==c?b=e([],c,b):d.named.test(c)&&(b=e({},c,b));return b}function g(a){return void 0===n[a]&&(n[a]=0),n[a]++}function h(a){switch(b('[name="'+a.name+'"]',c)[0].type){case"checkbox":return"on"===a.value||a.value;default:return a.value}}function i(b){if(!d.validate.test(b.name))return this;var c=f(b.name,h(b));return m=a.extend(!0,m,c),this}function j(b){if(!a.isArray(b))throw new Error("formSerializer.addPairs expects an Array");for(var c=0,d=b.length;c<d;c++)this.addPair(b[c]);return this}function k(){return m}function l(){return JSON.stringify(k())}var m={},n={};this.addPair=i,this.addPairs=j,this.serialize=k,this.serializeJSON=l}var d={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,named:/^[a-z0-9_]+$/i};return c.patterns=d,c.serializeObject=function(){return new c(b,this).addPairs(this.serializeArrayWithEmpty()).serialize()},c.serializeJSON=function(){return new c(b,this).addPairs(this.serializeArrayWithEmpty()).serializeJSON()},void 0!==b.fn&&(b.fn.serializeObject=c.serializeObject,b.fn.serializeJSON=c.serializeJSON),a.FormSerializer=c,c}),$.prettifyHTML=function(a){if(a=$(a),a.parent().length>0&&a.parent().data("assign")?a.data("assign",a.parent().data("assign")+1):a.data("assign",1),a.children().length>0)a.children().each(function(){for(tbc="",i=0;i<$(this).parent().data("assign");i++)tbc+="\t";$(this).before("\n"+tbc),$(this).prepend("\t"),$(this).append("\n"+tbc),$.prettifyHTML($(this))});else{for(tbc="",i=0;i<a.parent().data("assign");i++)tbc+="\t";a.prepend("\n"+tbc)}return a.outerHTML()},$.fn.replaceTagName=function(a){for(var b=[],c=this.length;c--;){for(var d=document.createElement(a),e=this[c],f=e.attributes,g=f.length-1;g>=0;g--){var h=f[g];d.setAttribute(h.name,h.value)}d.innerHTML=e.innerHTML,$(e).replaceWith(d),b[c]=d}return $(b)},$.fn.jModel=function(a,b){if(this.length<=1){var c=jstack.dataBinder.getControllerData(this[0]);return void 0!==a?void 0===c[a]?b:c[a]:c}var d=[];return this.each(function(){d.push($(this).jModel(a,b))}),d},$.fn.findComments=function(a){var b=[];return this.each(function(){for(var c=0;c<this.childNodes.length;c++){var d=this.childNodes[c];d.nodeType!==Node.COMMENT_NODE||a&&d.nodeValue.split(" ")[0]!=a?b.push.apply(b,$.fn.findComments.call($(d))):b.push(d)}}),$(b)},$.fn.findCommentsChildren=function(a){var b=[];return this.each(function(){for(var c=0;c<this.childNodes.length;c++){var d=this.childNodes[c];d.nodeType===Node.COMMENT_NODE&&d.nodeValue.split(" ")[0]==a?b.push.apply(b,$(d).commentChildren()):b.push.apply(b,$.fn.findCommentsChildren.call($(d),a))}}),$(b)},$.fn.commentChildren=function(){var a=[];return this.each(function(){for(var b="/"+this.nodeValue.split(" ")[0],c=this.nextSibling;c&&(c.nodeType!==Node.COMMENT_NODE||c.nodeValue!=b);)a.push(c),c=c.nextSibling}),$(a)},$.fn.parentComment=function(a){var b=[];for(n=this[0].previousSibling;n;){if(n.nodeType===Node.COMMENT_NODE&&n.nodeValue.split(" ")[0]===a){b.push(n);break}n=n.previousSibling}return $(b)},$.fn.parentsComment=function(a){var b=[];for(n=this[0].previousSibling;n;)n.nodeType===Node.COMMENT_NODE&&n.nodeValue.split(" ")[0]===a&&(b.push(n),n=n.parentNode),n&&(n=n.previousSibling);return $(b)},$.fn.dataCommentJSON=function(){if(arguments.length>1||"object"==$.type(arguments[0])){var a;if(arguments.length>1)a={},a[arguments[0]]=arguments[1];else var a=arguments[0];return this.each(function(){var b=this.nodeValue.split(" "),c=b.shift(),d=b.length?JSON.parse(b.join(" ")):{};$.extend(d,a),this.nodeValue=c+" "+JSON.stringify(d)})}var b=this[0].nodeValue.split(" ");b.shift();var c=b.length?JSON.parse(b.join(" ")):{};return arguments.length&&(c=c[arguments[0]]),c},function(){var a=0,b={};$.fn.removeDataComment=function(a){var c=this[0],d=c.nodeValue.split(" ");if(d[1]){var e=d[1];b[e]&&(a?b[e][a]&&delete b[e][a]:delete b[e])}},$.fn.dataComment=function(){if(arguments.length>1||"object"==$.type(arguments[0])){var c;if(arguments.length>1)c={},c[arguments[0]]=arguments[1];else var c=arguments[0];return this.each(function(){var a=$(this).dataComment();$.extend(a,c)})}var d,e=this[0],f=e.nodeValue.split(" "),g=f.shift();f.length?d=f[0]:(d=++a,e.nodeValue=g+" "+d),b[d]||(b[d]={});var h=b[d];return arguments.length&&(h=h[arguments[0]]),h}}(),$.fn.jData=function(a){if(this.length>1){var b=[];return this.each(function(){b.push($.fn.jData.call($(this),a))}),b}var b={},c=this[0];$.each(this.attrStartsWith("j-data-"),function(a,d){var e,f=jstack.dataBinder.textTokenizer(d);e=f===!1?d:jstack.dataBinder.compilerAttrRender(c,f),b[a]=e});var d={};return $.each(b,function(a,b){$.attrsToObject(a.substr(7),b,d)}),a&&(d=jstack.dataBinder.dotGet(a,d)),d},$.fn.onJstackReady=function(a,b,c){if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(var d in a)this.onJstackReady(d,b,c,a[d]);return this}var e,f=[a];return"string"==typeof b?(f.push(b),e=c):e=b,f.push(function(){var a=arguments,b=this;return jstack.ready(function(){e.apply(b,a)})}),this.on.apply(this,f)},$.onJstackReady=function(a,b,c){return $(document).onReady(a,b,c)},$.xhrPool=[],$.xhrPool.abortAll=function(a){$(this).each(function(b,c){a!==!0&&a!=c.jstackNS||(c.abort(),$.xhrPool.splice(b,1))})},$(document).ajaxSend(function(a,b){$.xhrPool.push(b)}),$(document).ajaxComplete(function(a,b){var c=$.xhrPool.indexOf(b);c>-1&&$.xhrPool.splice(c,1)}),$.ajaxPrefilter(function(a,b,c){c.jstackNS=a.namespace||jstack.ajaxNamespace}),$.fn.onFirst=function(a,b){var c=$(this);c.off(a,b),c.on(a,b);var d=$._data(c[0]).events,e=d[a];e.unshift(e.pop()),d[a]=e},$.fn.onLast=function(a,b){return this.each(function(){var c=1e6,d=a.split("."),e=d[0];$(this).on(a,b);var f=$._data(this,"events"),g=!1,h={};if($.each(f[e],function(a,c){c===b&&(g=a),h[a]=1}),g!==!1){for(;1==h[c];)c++;f[e][c]=f[e][g],delete f[e][g]}})},function(){var a={},b={};jstack.getTemplate=function(c,d){if(d||(c=jstack.config.templatesPath+c),!b[c]){var e=c;if(jstack.config.debug){var f=(new Date).getTime().toString();e.indexOf("_t=")===-1&&(e+=(e.indexOf("?")<0?"?":"&")+"_t="+f)}b[c]=$.Deferred(),$.ajax({url:e,cache:!0}).then(function(d){a[c]=d,b[c].resolve(d,c)})}return b[c].promise()}}(),jstack.route=function(a,b){var c=[],d={},e=function(a,b){this.name=b,this.path=a,this.keys=[],this.fns=[],this.params={},this.regex=f(this.path,this.keys,!1,!1)};e.prototype.addHandler=function(a){this.fns.push(a)},e.prototype.removeHandler=function(a){for(var b=0,c=this.fns.length;b<c;b++){if(a==this.fns[b])return void this.fns.splice(b,1)}},e.prototype.run=function(a,b){$(document).trigger("j:route:unload");for(var c=a.shift(),d=0,e=this.fns.length;d<e;d++){var f=this.fns[d].call(this,c,a,b);"object"==$.type(f)&&"then"in f?f.then(function(){$(document).trigger("j:route:loaded",[c,a,b])}):$(document).trigger("j:route:loaded",[c,a,b])}},e.prototype.match=function(a,b){var c=this.regex.exec(a);if(!c)return!1;b.push(a);for(var d=1,e=c.length;d<e;++d){var f=this.keys[d-1],g="string"==typeof c[d]?decodeURIComponent(c[d]):c[d];f&&(this.params[f.name]=g),b.push(g)}return!0},e.prototype.toURL=function(a){var b=this.path;for(var c in a)b=b.replace("/:"+c,"/"+a[c]);if(b=b.replace(/\/:.*\?/g,"/").replace(/\?/g,""),b.indexOf(":")!=-1)throw new Error("missing parameters for url: "+b);return b};var f=function(a,b,c,d){return a instanceof RegExp?a:(a instanceof Array&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push({name:e,optional:!!g}),c=c||"",(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))},g=function(a,b){var f=a.split(" "),g=2==f.length?f[0]:null;a=2==f.length?f[1]:f[0],d[a]||(d[a]=new e(a,g),c.push(d[a])),c=c.sort(function(a,b){return"*"==a.path||c.indexOf(a)>c.indexOf(b)}),h.singleHandler&&(d[a].fns=[]),d[a].addHandler(b)},h=function(a,c,d){if("function"==typeof c)g(a,c);else if("object"==typeof a)for(var e in a)g(e,a[e]);else if(void 0===c)h.navigate(a);else if("object"==typeof c){var f={};d&&$.extend(f,w()),$.extend(f,b.getParams(a),c);var i=b.buildQuery(f);i&&(i="?"+i),a=b.getPath(a),h.navigate(a+i)}};h.lookup=function(a,b){for(var d=0,e=c.length;d<e;d++){var f=c[d];if(f.name==a)return f.toURL(b)}},h.remove=function(a,b){var c=d[a];c&&c.removeHandler(b)},h.removeAll=function(){d={},c=[]},h.navigate=function(b,c){c=c||{};var d=c.silent||!1;d&&t(),setTimeout(function(){a.location.hash=b,d&&setTimeout(function(){s()},1)},1)};var i=function(){var a="",b=n.substring(1),c=b.indexOf("#");return c!==-1&&(a=b.substr(c+1)),a},j=function(){var a=n.substring(1),b=a.indexOf("#");return b!==-1&&(a=a.substr(0,b)),a},k=function(a,b,c){var d=[];return!!b.match(a,d)&&(b.run(d,c),!0)},l=function(a){for(var b=h.getPath(a),d=0,e=c.length;d<e;d++){if(k(b,c[d],a))return}};h.load=l;var m,n=a.location.hash,o=function(b){n=b?b.newURL.substr(b.newURL.indexOf("#")):a.location.hash;var c=j();c!=m?(m=c,$(document).trigger("j:route:load"),l(m)):$(document).trigger("j:subroute:change")};h.reload=o;var p=function(b){var c=this.getAttribute("href");if(c)return"/"+c==a.location.pathname?(b.preventDefault(),jstack.route(""),!1):void("##"==c.substr(0,2)&&(b.preventDefault(),r(c.substr(2))))},q=function(b){var c=b+"#"+i();a.location.hash=c},r=function(b){var c=m+"#"+b;a.location.hash=c},s=function(){a.addEventListener?a.addEventListener("hashchange",o,!1):a.attachEvent("onhashchange",o),$(document).on("click","a",p),h.reload()},t=function(){a.removeEventListener?a.removeEventListener("hashchange",o):a.detachEvent("onhashchange",o),$(document).off("click","a",p)};h.start=s,h.stop=t;var u=function(){return b.getQuery(j())},v=function(){return b.getPath(j())},w=function(){return b.getParams(j())},x=function(a){return w()[a]},y=function(){return b.getParams("?"+i())},z=function(a){return y()[a]};h.getHash=j,h.getHash2=i,h.getParams=w,h.getParam=x,h.getSubParams=y,h.getSubParam=z,h.getQuery=u,h.getPath=v,h.setMainHash=q,h.setSubHash=r,h.singleHandler=!0;var A=document.getElementsByTagName("base")[0];if(A)h.baseHref=A.href;else{var B=window.location,C=B.pathname;C=C.split("/"),C.pop(),C=C.join("/")||"/";var D,E=B.username?B.username+(B.password?":"+B.password:"")+"@":"";D=B.port&&("https"==B.protocol&&"443"!=B.port||"80"!=B.port)?":"+B.port:"",h.baseHref=B.protocol+"//"+E+B.host+D+C}var F=a.location.href;F=F.split("/"),F=F[0]+"//"+F[2],F=h.baseHref.substr(F.length),h.basePath=F;var G=a.location.href.substr(h.baseHref.length),H=G.indexOf("#");return H>-1&&(G=G.substr(0,H)),h.baseLocation=G,h}(window,jstack.url),jstack.routeMVC=function(a,b){return jstack.route(a,function(a,c,d){let e=$("[j-app]");return"string"==typeof b&&(b={view:b}),e.empty(),jstack.mvc({view:b.view,controller:b.controller||b.view,hash:d,target:$("<div/>").appendTo(e)})})},jstack.ready=function(a){var b=$.Deferred(),c=[jstack.dataBinder.updateDeferStateObserver];if(jstack.dataBinder.loadingMutation>0){var d=$.Deferred();jstack.dataBinder.deferMutation.push(function(){d.resolve()}),c.push(d)}return $.when.apply($,c).then(function(){b.resolve()}),a&&b.then(function(){a()}),b.promise()},jstack.dataBinder=function(){var a=function(){};a.prototype={dotGet:function(a,b,c){if("object"==typeof b&&null!==b)return a.split(".").reduce(function(a,b){return"object"==typeof a&&null!==a&&void 0!==a[b]?a[b]:c},b)},dotSet:function(a,b,c,d){if("object"==typeof b&&null!==b)return a.split(".").reduce(function(a,b,e,f){if(f.length!=e+1)return"object"==typeof a[b]&&null!==a[b]||(a[b]={}),a[b];d&&a[b]&&(c=a[b]),d&&a[b]||(a[b]=c)},b),c},dotDel:function(a,b,c){"object"==typeof b&&null!==b&&a.split(".").reduce(function(a,b,c,d){if("object"==typeof a)return d.length!=c+1?a[b]:void(void 0!==a[b]&&delete a[b])},b)},
getKey:function(a){return a.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").replace(/\[\]/g,".")},getClosestFormNamespace:function(a){for(;a;){if(a.tagName&&"form"==a.tagName.toLowerCase()){if(a.hasAttribute("j-name"))return a.getAttribute("j-name");break}a=a.parentNode}},getValue:function(a,b,c){var d=this.getControllerData(a),e="",f=this.getClosestFormNamespace(a.parentNode);return f&&(e+=f+"."),e+=b,this.dotGet(e,d,c)},getParentsForId:function(a){for(var b=[],c=a;c&&(c.nodeType===Node.COMMENT_NODE&&"j:for:id"===c.nodeValue.split(" ")[0]&&(b.push(c),c=c.parentNode),c&&(c=c.previousSibling?c.previousSibling:c.parentNode),c!==document.body););return b},getValueEval:function(a,b){var c=$(this.getController(a)),d=c.data("jController"),e=c.data("jModel");if(document.contains(a)){e=e?JSON.parse(JSON.stringify(e)):{},void 0===b?b="undefined":null===b?b="null":""==b.trim()?b="undefined":(b=b.replace(/[\r\t\n]/g,""),b=b.replace(/(?:^|\b)(this)(?=\b|$)/g,"$this"));for(var f=this.getParentsForId(a).reverse(),g=0,h=f.length;g<h;g++){var i=f[g],j=$(i),k=j.parentComment("j:for");if(!k.length)return;var l=k.dataCommentJSON(),m=l.value,n=j.dataComment("j:for:data");e[m]=n;var o=l.key,p=l.index;if(p&&(e[p]=j.index()+1),o){var q=i.nodeValue.split(" ")[1];e[o]=q}}var r=["$controller","$this","$scope"],s=[d,a,e];$.each(e,function(a,b){r.push(a),s.push(b)}),r.push("return "+b+";");var m;try{m=Function.apply(null,r).apply(null,s)}catch(c){if(jstack.config.debug){var t=[c.message,", expression: "+b,"element",a];a.nodeType==Node.COMMENT_NODE&&t.push($(a).parent().get()),console.warn.apply(console,t)}}return void 0===m?"":m}},getScopedInput:function(a){var b=a.getAttribute("name"),c=this.getKey(b);if("."==c.substr(-1)&&"checkbox"==a.type){var d;$(this.getController(a.parentNode)).find(':checkbox[name="'+b+'"]').each(function(b){if(this===a)return d=b,!1}),c+=d}var e="",f=this.getClosestFormNamespace(a.parentNode);return f&&(e+=f+"."),e+=c},getters:{select:function(a){return $(a).val()},input:function(a){switch(a.type){case"checkbox":var b=$(a);return b.prop("checked")?b.val():"";case"radio":for(var c,d=a.parentNode;d;){if(d.tagName&&"form"==d.tagName.toLowerCase()){c=d;break}d=d.parentNode}if(c){var e=$(c).find('[name="'+a.getAttribute("name")+'"]:checked');return e.length?e.val():""}return"";case"file":return a.files;case"submit":break;default:return $(a).val()}},textarea:function(a){return $(a).val()},"j-select":function(a){a=$(a);var b=a[0].hasAttribute("multiple"),c=a.data("preselect");return c||(b&&(c=[]),a.children().each(function(){if(this.hasAttribute("selected")){var a=this.value;if(!b)return c=a,!1;c.push(a)}})),c}},defaultGetter:function(a){return $(a).html()},getInputVal:function(a){var b=a.tagName.toLowerCase();return(this.getters[b]||this.defaultGetter)(a)},inputToModel:function(a,b,c){var d,e=$(a),f=this,g=this.getControllerData(a),h=(a.getAttribute("name"),function(){var c=f.getScopedInput(a);i!=d&&(d=i,e.populateInput(d,{preventValEvent:!0}));var h=f.dotGet(c,g);d=f.dotSet(c,g,d),e.trigger("j:input",[d]),"j:update"==b?e.trigger("j:input:update",[d]):e.trigger("j:input:user",[d]),h!==d&&e.trigger("j:change",[d,h])});d=void 0!==c?c:this.getInputVal(a);var i=this.filter(a,d);"object"==typeof i&&null!==i&&"function"==typeof i.promise?i.then(function(a){i=a,h()}):h()},watchersPrimary:0,watchers:{},addWatcher:function(a,b){b||(b=0),this.watchers[b]||(this.watchers[b]={}),this.watchers[b][++this.watchersPrimary]=a},checkRemoved:function(a){for(;a.parentNode;)a=a.parentNode;return $(a).data("j:if:state")!==!1},runWatchers:function(){var a=this;$.each(this.watchers,function(b,c){$.each(c,function(b,d){var e=d();e&&a.checkRemoved(e)&&delete c[b]})})},updateDeferQueued:!1,updateDeferInProgress:!1,updateDeferStateObserver:null,update:function(){var a=this;this.updateDeferQueued||(this.updateDeferInProgress?this.updateDeferQueued=!0:(this.updateDeferInProgress=!0,this.updateDeferStateObserver||(this.updateDeferStateObserver=$.Deferred()),setTimeout(function(){a.runWatchers(),a.updateDeferQueued?(a.updateDeferInProgress=!1,a.updateDeferQueued=!1,a.update()):(a.updateDeferStateObserver.resolve(),a.updateDeferStateObserver=null,a.updateDeferInProgress=!1)},10)))},compileNode:function(a,b){var c=this;jstack.walkTheDOM(a,function(a){if(!document.body.contains(a))return!1;if(c.observe(a)===!1)return!1;var d=$(a);if(a.nodeType==Node.TEXT_NODE&&a instanceof Text){var e=jstack.dataBinder.compilerText.call(a);if(e)for(var f=0,g=e.length;f<g;f++)c.addWatcher(e[f],99),e[f]()}else if(a.nodeType==Node.ELEMENT_NODE){var h=a.hasAttribute("j-once");if(h?(jstack.walkTheDOM(a,function(a){a.nodeType==Node.ELEMENT_NODE&&a.setAttribute("j-once-element","true")}),a.removeAttribute("j-once")):(h=a.hasAttribute("j-once-element"))&&a.removeAttribute("j-once-element"),$.each(c.compilers,function(b,d){var e=d.match.call(a);if(e){var f=d.callback.call(a,e);f&&(h||c.addWatcher(f,d.level),f())}}),!document.body.contains(a))return!1;b.push(function(){a.hasAttribute("j-cloak")&&a.removeAttribute("j-cloak"),d.data("j:load:state")||(d.data("j:load:state",!0),jstack.trigger(a,"load"))})}})},loadingMutation:0,deferMutation:[],loadMutations:function(a){var b=this,c=[];$.each(a,function(a,d){$.each(d.addedNodes,function(a,d){b.compileNode(d,c)}),$.each(d.removedNodes,function(a,c){jstack.walkTheDOM(c,function(a){return a.nodeType===Node.COMMENT_NODE&&b.checkRemoved(a)?($(a).removeDataComment(),!1):a.nodeType!=Node.TEXT_NODE&&(!!$(a).data("j:load:state")&&void jstack.trigger(a,"unload"))})})}),setTimeout(function(){if(0==--b.loadingMutation)for(;b.deferMutation.length;)b.deferMutation.pop()();for(var a=0,d=c.length;a<d;a++)c[a]()})},noChildListNodeNames:{area:1,base:1,br:1,col:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,menuitem:1,meta:1,param:1,source:1,track:1,wbr:1,script:1,style:1,textarea:1,title:1,math:1,svg:1,canvas:1},inputPseudoNodeNames:{input:1,select:1,textarea:1},observe:function(a){if(a.nodeType==Node.ELEMENT_NODE){if(a.hasAttribute("j-escape"))return!1;if(!this.noChildListNodeNames[a.tagName.toLowerCase()]){var b=this,c=new MutationObserver(function(a){b.loadingMutation++,setTimeout(function(){b.loadMutations(a)})});c.observe(a,{subtree:!1,childList:!0,characterData:!0,attributes:!1,attributeOldValue:!1,characterDataOldValue:!1}),$(a).data("j:observer",c)}}},eventListener:function(){var a=this;jstack.walkTheDOM(document.body,function(b){return a.observe(b)}),$(document.body).on("input change j:update",":input[name]",function(b,c){"file"!=this.type&&("input"!=b.type||"select"!=this.nodeName.toLowerCase()&&"checkbox"!=this.type&&"radio"!=this.type)&&a.inputToModel(this,b.type,c)})},filter:function(a,b){var c=this.getFilter(a);return"function"==typeof c&&(b=c(b)),b},getFilter:function(a){$el=$(a);var b=$el.data("j-filter");if(!b){var c=a.getAttribute("j-filter");if(c){var d=this.getValue(a,c);$el.data("j-filter",d)}}return b},getControllerData:function(a){return $(this.getController(a)).data("jModel")},getController:function(a){let b;for(;a;){if(a.hasAttribute&&a.hasAttribute("j-controller")){b=a;break}a=a.parentNode}return b||(b=document.body,b.setAttribute("j-controller",""),$(b).data("jModel",{})),b},getControllerObject:function(a){return $(this.getController(a)).data("jController")},inputPseudoNodeNamesExtended:{input:1,select:1,textarea:1,button:1,"j-input":1,"j-select":1},compilers:{jFixedController:{level:0,match:function(){return this.hasAttribute("j-fixed-controller")},callback:function(){this.removeAttribute("j-fixed-controller");let a=$(jstack.dataBinder.getController(this)).data();$(this).data({jController:a.jController,jModel:a.jModel}),this.setAttribute("j-controller","__fixed")}},jFor:{level:1,match:function(){return this.hasAttribute("j-for")},callback:function(){var a=this,b=$(this),c=$("<!--j:for-->"),d=$("<!--/j:for-->");b.replaceWith(c),d.insertAfter(c);var e=a.getAttribute("j-for");a.removeAttribute("j-for"),e=e.trim();var f,g,h,i,j=new RegExp("(\\()(.*)(,)(.*)(,)(.*)(\\))(\\s+)(in)(\\s+)(.*)",["i"]),k=j.exec(e);if(null!=k)f=k[2].trim(),g=k[4].trim(),h=k[6],i=k[11].trim();else{var j=new RegExp("(\\()(.*)(,)(.*)(\\))(\\s+)(in)(\\s+)(.*)",["i"]),k=j.exec(e);if(null!=k)g=k[2].trim(),h=k[4],i=k[9].trim();else{var j=new RegExp("(.*)(\\s+)(in)(\\s+)(.*)",["i"]),k=j.exec(e);if(null==k)throw new Error("Malformed for clause: "+e);h=k[1],i=k[5].trim()}}var l,m=function(){return jstack.dataBinder.getValueEval(c[0],i)};c.dataCommentJSON({value:h,key:g,index:f});let n="template"==a.tagName.toLowerCase();var o=this.content;return function(){if(!document.body.contains(c[0]))return c[0];var a=m();if(l!==a){l=a,a||(a=[]);var e=[],f=$(c.commentChildren().map(function(){if(this.nodeType===Node.COMMENT_NODE&&"j:for:id"==this.nodeValue.split(" ")[0])return this}));$.each(a,function(a,c){var g=$(f.map(function(){if(this.nodeValue=="j:for:id "+a)return this})),h=!g.length;if(h&&(g=$("<!--j:for:id "+a+"-->")),g.dataComment("j:for:data",c),h){g.insertBefore(d);let c;n?c=$(document.importNode(o,!0)):(c=b.clone(),c.attr("j-for-id",a)),c.insertBefore(d),$("<!--/j:for:id-->").insertBefore(d)}e.push(a.toString())}),f.each(function(){var a=this.nodeValue.split(" ")[1];e.indexOf(a)===-1&&($(this).commentChildren().remove(),$(this).remove())})}}}},jIf:{level:2,match:function(){return this.hasAttribute("j-if")&&document.contains(this)},callback:function(){var a=this,b=$(this),c=$("<!--j:if-->");b.before(c);var d=b.nextUntil("[j-if]","[j-else-if]"),e=b.nextUntil("[j-if]","[j-else]");"template"==this.tagName.toLowerCase()&&(b=$(jstack.fragmentToHTML(this)),$(a).detach());var f;f=e.length?e:d.length?d.last():c,$("<!--/j:if-->").insertAfter(f);var g=a.getAttribute("j-if");a.removeAttribute("j-if");var h,i,j=function(){return Boolean(jstack.dataBinder.getValueEval(c[0],g))},k=null;if(d.length){var l=[],m=[];d.each(function(){l.push(this.getAttribute("j-else-if")),this.removeAttribute("j-else-if"),"template"==this.tagName.toLowerCase()?$("<div>"+jstack.fragmentToHTML(this)+"</div>").contents().each(function(){m.push(this)}):m.push(node)}),d=$(m),i=function(){for(var a=!1,b=0,d=l.length;b<d;b++)if(Boolean(jstack.dataBinder.getValueEval(c[0],l[b]))){a=b;break}return a}}if(e.length){var n=[];e.each(function(){this.removeAttribute("j-else"),"template"==this.tagName.toLowerCase()?$("<div>"+jstack.fragmentToHTML(this)+"</div>").contents().each(function(){n.push(this)}):n.push(this)}),e=$(n)}return function(){if(!document.body.contains(c[0]))return c[0];var a=j(),f=null;if(i&&(f=!a&&i()),h!==a||f!==k)if(h=a,k=f,b.data("j:if:state",a),a)b.insertAfter(c),d.length&&(d.data("j:if:state",!1),d.detach()),e.length&&(e.data("j:if:state",!1),e.detach());else{if(b.detach(),d.length)if(d.data("j:if:state",!1),f===!1)d.detach();else{var g=$(d[f]);g.data("j:if:state",!0),g.insertAfter(c)}e.length&&(f===!1||null===f?(e.data("j:if:state",!0),e.insertAfter(c)):(e.data("j:if:state",!1),e.detach()))}}}},jSwitch:{level:3,match:function(){return this.hasAttribute("j-switch")},callback:function(){var a=this,b=$(this),c=this.getAttribute("j-switch");this.removeAttribute("j-switch");var d,e=b.find("[j-case],[j-case-default]"),f=function(){return Boolean(jstack.dataBinder.getValueEval(a,c))};return function(){if(!document.body.contains(a))return a;var c=f();if(d!==c){d=c;var g=!1;e.filter("[j-case]").each(function(){var a=$(this);this.getAttribute("j-case")==c?(a.appendTo(b),g=!0):a.detach()}),e.filter("[j-case-default]").each(function(){var a=$(this);g?a.detach():a.appendTo(b)})}}}},jShow:{level:4,match:function(){return this.hasAttribute("j-show")},callback:function(){var a=this,b=$(this),c=this.getAttribute("j-show");this.removeAttribute("j-show");var d,e=function(){return Boolean(jstack.dataBinder.getValueEval(a,c))};return function(){if(!document.body.contains(a))return a;var c=e();d!==c&&(d=c,c?b.show():b.hide())}}},jHref:{level:5,match:function(){return this.hasAttribute("j-href")},callback:function(){var a=this,b=($(this),this.getAttribute("j-href"));this.removeAttribute("j-href");var c=jstack.dataBinder.textTokenizer(b);if(c===!1)return void a.setAttribute("href",jstack.route.baseLocation+"#"+b);var d,e=jstack.dataBinder.createCompilerAttrRender(a,c);return function(){if(!document.body.contains(a))return a;var b=e();d!==b&&(d=b,a.setAttribute("href",jstack.route.baseLocation+"#"+b))}}},jTwoPoints:{level:6,match:function(){for(var a,b=0,c=this.attributes,d=c.length;b<d;b++){var e=c[b];":"===e.name.substr(0,1)&&(a||(a={}),a[e.name]=e.value)}return a},callback:function(a){var b=this,c=$(this),d={},e={},f=["selected","checked"];this.nodeName.toLowerCase();return $.each(a,function(a,c){var e=jstack.dataBinder.textTokenizer(c),f=a.substr(1);e===!1?b.setAttribute(f,c):d[f]=e,b.removeAttribute(a)}),function(){if(!document.body.contains(b)||0==d.length)return b;$.each(d,function(a,d){var g=jstack.dataBinder.compilerAttrRender(b,d);e[a]!==g&&(e[a]=g,f.indexOf(a)!==-1?c.prop(a,g):"boolean"==typeof g?g?b.setAttribute(a,a):b.removeAttribute(a):b.setAttribute(a,g))})}}},jInputFile:{level:8,match:function(){return this.hasAttribute("name")&&"input"==this.tagName.toLowerCase()&&"file"==this.type},callback:function(){$(this).on("input change",function(a){jstack.dataBinder.inputToModel(this,a.type)})}},jInput:{level:8,match:function(){return this.hasAttribute("name")&&jstack.dataBinder.inputPseudoNodeNamesExtended[this.tagName.toLowerCase()]&&"file"!=this.type},callback:function(){var a,b=this,c=$(this),d=jstack.dataBinder.getScopedInput(this),e=jstack.dataBinder.getInputVal(this);jstack.dataBinder.dotSet(d,jstack.dataBinder.getControllerData(b),e,!0);var f=function(){var a=jstack.dataBinder.getInputVal(b),c=jstack.dataBinder.getKey(b.getAttribute("name"));return jstack.dataBinder.getValue(b,c,a)};return function(){if(!document.body.contains(b))return b;var d=f();a!==d&&(a=d,c.data("j:populate:prevent")||(c.populateInput(d,{preventValEvent:!0}),c.trigger("j:val",[d])))}}}},compilerAttrRender:function(a,b){for(var c="",d=0,e=b.length;d<e;d++){var f=b[d];"{{"==f.substr(0,2)&&(f=jstack.dataBinder.getValueEval(a,f.substr(2,f.length-4))),c+=f?f:""}return c},createCompilerAttrRender:function(a,b){return function(){return jstack.dataBinder.compilerAttrRender(a,b)}},createCompilerTextRender:function(a,b){var c;return function(){if(!document.body.contains(a[0]))return a[0];var d=jstack.dataBinder.getValueEval(a[0],b);c!==d&&(c=d,a.commentChildren().remove(),a.after(d))}},compilerText:function(){if(this.textContent){var a=this.textContent.toString(),b=jstack.dataBinder.textTokenizer(a);if(b!==!1){for(var c=$(this),d=[],e=c,f=0,g=b.length;f<g;f++){var h=b[f];if("{{"==h.substr(0,2)){var i=$("<!--j:text-->"),j=$("<!--/j:text-->");i.insertAfter(e),j.insertAfter(i),e=j,h=h.substr(2,h.length-4),d.push(jstack.dataBinder.createCompilerTextRender(i,h))}else h=document.createTextNode(h),e.after(h),e=h}return c.remove(),d}}},textTokenizer:function(a){var b=/\{\{((?:.|\n)+?)\}\}/g;if(!b.test(a))return!1;for(var c,d,e=[],f=b.lastIndex=0;c=b.exec(a);){d=c.index,d>f&&e.push(a.slice(f,d));var g=c[1].trim();e.push("{{"+g+"}}"),f=d+c[0].length}return f<a.length&&e.push(a.slice(f)),e}};var b=new a;return b.eventListener(),b}(),$.on("reset","form",function(){$(this).populateReset()}),jstack._eventStack={},jstack.trigger=function(a,b){let c=$(a),d=c.data("j:event:"+b);d&&d.forEach(function(b){b.call(a)}),jstack._eventStack[b]&&$.each(jstack._eventStack,function(b,d){c.is(b)&&d.forEach(function(b){b.call(a)})})},jstack.on=function(a,b,c){if(jstack._eventStack[a]||(jstack._eventStack[a]={}),"string"==typeof b)void 0===jstack._eventStack[b]&&(jstack._eventStack[b]=[]),jstack._eventStack[b].push(c);else{let d=$(b),e=d.data("j:event:"+a);e||(e=[],d.data("j:event:"+a,e)),e.push(c)}},jstack.loader=function(a,b,c){jstack.on("load",a,function(){b.call(this)}),"function"==typeof c&&jstack.on("unload",a,function(){c.call(this)}),$(a).each(function(){b.call(this)})},$.fn.onLoad=function(a){return this.each(function(){jstack.on("load",this,a)})},$.fn.onUnload=function(a){return this.each(function(){jstack.on("unload",this,a)})},jstack.component={},jstack.loader(':attrStartsWith("j-on-")',function(){var a=$(this),b=a.attrStartsWith("j-on-"),c=jstack.dataBinder.getControllerObject(this);$.each(b,function(b,d){var e=b.substr(5);a[0].removeAttribute(b),a.on(e,function(a){if("object"!=typeof c.methods||"function"!=typeof c.methods[d])throw new Error('Call to undefined method "'+d+'" by '+b+" and expected in controller "+c.name);var e=c.methods[d];if("function"==typeof e){return e.call(c,a,this)!==!1&&void 0}})})}),jstack.loader("[j-component]",function(){var a=this,b=$(a),c=a.getAttribute("j-component");if(c&&!a.getAttribute("j-component-handled")){a.setAttribute("j-component-handled","true");var d=b.jData(),e=a.getAttribute("j-params-data"),f=function(){var f,g=jstack.component[c];if(e){var h=[];h.push(a),f=new(Function.prototype.bind.apply(g,h))}else f=new g(a,d);b.data("j:component",f),f.deferred?f.deferred.then(function(){b.data("j.component.loaded",!0),b.trigger("j:component:loaded"),"function"==typeof f.unload&&jstack.on("unload",a,f.unload)}):(b.data("j.component.loaded",!0),b.trigger("j:component:loaded"),"function"==typeof f.unload&&jstack.on("unload",a,f.unload))};jstack.component[c]?f():$js("jstack."+c,f)}}),function(){var a=function(a){for(var b=[],c=$.param(a).split("&"),d=0;d<c.length;d++){var e=c[d].split("="),f=null!==e[1]?decodeURIComponent(e[1]):"";b.push([decodeURIComponent(e[0]),f])}return b},b=function(a,c,d,e){if(d||(d=""),a instanceof Array){for(var f={},g=0;g<a.length;g++)f[g]=a[g];return b(f,c,d,e)}if(void 0===a||null===a)a="";else if("object"==typeof a){var f={};Object.keys(a).forEach(function(g){var h=d+g,i=a[g];if(i instanceof FileList)if(1==i.length)c[h]=i[0];else{c[h]=[];for(var j=0;j<i.length;j++)c[h].push(i[j])}else f[g]=b(i,c,h+"_",e+1)}),a=f}return a};jstack.ajaxNamespace=void 0,jstack.ajax=function(){var c,d={};if(2==arguments.length?(c=arguments[1]||{},c.url=arguments[0]):c=arguments[0],c.data&&(c.data=b(c.data,d)),!$.isEmptyObject(d)){for(var e,f=new FormData,g=a(c.data),h=0;h<g.length;h++)f.append(g[h][0],g[h][1]);for(var i in d)if(d.hasOwnProperty(i)){var j=d[i];if(j instanceof Array)for(var h=0;h<j.length;h++)void 0!==j[h]&&(f.append(i+"[]",j[h]),e=!0);else void 0!==j&&(f.append(i,j),e=!0)}e&&(c.type="POST",c.processData=!1,c.contentType=!1,c.data=f)}return $.ajax(c)},jstack.post=function(a,b,c,d){let e=jstack.ajax({type:"POST",url:a,data:b,dataType:d});return"function"==typeof c&&e.then(c),e}}(),function(){jstack.mvc=function(a){var b=$(a.target),c=(a.controller,jstack.config.controllersPath+a.controller),d=$.Deferred(),d=$.Deferred();jstack.controllers[a.controller]?d.resolve():$js(c,d.resolve);var e=jstack.getTemplate(a.view+".jml"),f=$.Deferred();return d.then(function(){var c=jstack.controller(a.controller,b,a.hash);$.when(e,c).then(function(c,d){a.clear&&$(a.clear).contents().not(b).remove();var e=c[0],g=d.render(e);g?g.then(function(){f.resolve(b,d)}):f.resolve(b,d)})}),f.promise()};var a=function(a){if("string"==typeof arguments[0]){var b='[j-view="'+arguments[0]+'"]';a="object"==typeof arguments[1]?$(arguments[1]).find(b):$(b)}a=$(a);var c=a.data("jViewReady");return c||(c=$.Deferred(),a.data("jViewReady",c)),c};jstack.viewReady=function(b){return a(b).promise()},jstack.loader("[j-view]:not([j-view-loaded])",function(){this.setAttribute("j-view-loaded","true");var b,c=this.getAttribute("j-view");b=this.hasAttribute("j-controller")?this.getAttribute("j-controller"):c;var d=a(this);jstack.mvc({view:c,controller:b,target:this}).then(function(){d.resolve()})})}(),function(){jstack.app=function(a,b){b||(b=a[0].getAttribute("j-app")),jstack.config.templatesPath+=b+"/",jstack.config.controllersPath+=b+"/",$(document).on("j:route:unload",function(){$.xhrPool.abortAll()}),jstack.route("*",function(b,c,d){return b=jstack.url.getPath(b),jstack.mvc({view:b,controller:b,hash:d,target:$("<div/>").appendTo(a),clear:a[0]})})};var a=$("[j-app]");a.length&&jstack.app(a)}();