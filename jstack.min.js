jstackClass=function(){this.config={templatesPath:"view-js/",controllersPath:"controller-js/",defaultController:{},defaultTarget:"[j-app]",debug:$js.dev},this.controllers={}},jstackClass.prototype.extend=function(a,b){a.prototype=Object.create(b.prototype)},jstack=new jstackClass,function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.ObjectObservable=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],2:[function(a,b,c){var d=a("asap"),e=a("events"),f="__OBJECT_OBSERVABLE__PREFIX__"+new Date+"__",g={};g.create=function(a,b){function c(a){var b=function(b){l(b,a)};return k[a]=b,b}arguments.length||(a={});var b=Object.assign({},{clone:!1,recursive:!0},b),h=new e,i=[],j=!1,k=new WeakMap,l=function(a,b){var c=Object.assign({},a);b&&(c.path=a.path?b+"."+a.path:b),i.push(c),h.emit("change",c),j||(d(function(){h.emit("changes",i),j=!1,i=[]}),j=!0)},m=a;if(b.recursive)if(Array.isArray(a)){b.clone&&(m=[]);for(var n=0;n<a.length;++n){var o=a[n];"object"==typeof o&&o&&(g.isObservable(o)||(o=g.create(o),m[n]=o),g.observeInmediate(o,c(n)))}}else{b.clone&&(m={});for(var p in a)if(a.hasOwnProperty(p)){var o=a[p];"object"==typeof o&&o&&(g.isObservable(o)||(o=g.create(o),m[p]=o),g.observeInmediate(o,c(p)))}}return new Proxy(m,{get:function(a,b){return b===f?h:a[b]},set:function(a,d,e){var f=a[d],h=k[d];return f&&h&&g.unobserveInmediate(f,h),b.recursive&&"object"==typeof e&&e?(g.isObservable(e)||(e=g.create(e)),a[d]=e,g.observeInmediate(e,c(d))):a[d]=e,l({type:"set",target:a,key:d,value:e,old:f},d),e},deleteProperty:function(a,b){var c=a[b],d=k[b];return c&&d&&g.unobserveInmediate(c,d),c=Array.isArray(a)?a.splice(b,1):delete a[b],l({type:"deleteProperty",target:a,key:b},b),c},has:function(a,b){return f===b||b in a}})},g.isObservable=function(a){return"object"==typeof a&&a&&f in a},g.observe=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");return c.addListener("changes",b),b},g.once=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");return c.once("changes",b),b},g.unobserve=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");c.removeListener("changes",b)},g.observeInmediate=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");c.addListener("change",b)},g.unobserveInmediate=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");return c.removeListener("change",b)},b.exports=g},{asap:3,events:1}],3:[function(a,b,c){"use strict";function d(){if(i.length)throw i.shift()}function e(a){var b;b=h.length?h.pop():new f,b.task=a,g(b)}function f(){this.task=null}var g=a("./raw"),h=[],i=[],j=g.makeRequestCallFromTimer(d);b.exports=e,f.prototype.call=function(){try{this.task.call()}catch(a){e.onerror?e.onerror(a):(i.push(a),j())}finally{this.task=null,h[h.length]=this}}},{"./raw":4}],4:[function(a,b,c){(function(a){"use strict";function c(a){h.length||(g(),i=!0),h[h.length]=a}function d(){for(;j<h.length;){var a=j;if(j+=1,h[a].call(),j>k){for(var b=0,c=h.length-j;b<c;b++)h[b]=h[b+j];h.length-=j,j=0}}h.length=0,j=0,i=!1}function e(a){var b=1,c=new l(a),d=document.createTextNode("");return c.observe(d,{characterData:!0}),function(){b=-b,d.data=b}}function f(a){return function(){function b(){clearTimeout(c),clearInterval(d),a()}var c=setTimeout(b,0),d=setInterval(b,50)}}b.exports=c;var g,h=[],i=!1,j=0,k=1024,l=a.MutationObserver||a.WebKitMutationObserver;g="function"==typeof l?e(d):f(d),c.requestFlush=g,c.makeRequestCallFromTimer=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2])(2)}),jstack.controller=function(a,b){if("object"==typeof a)return jstack.controllers[a.name]=function(b){var c=this,d=b.data("jModel")||{};if(b.hasAttr("j-view-inherit")){var e=b.parent().closest("[j-controller]");if(e.length){var f=b.attr("j-view-inherit"),g=e.data("jModel")||{};f?d[f]=g:d=$.extend({},g,d)}}b.find(":input[name],[j-input],[j-select]").each(function(){var a=jstack.dataBinder.getScopedInput(this),b=jstack.dataBinder.getInputVal(this);jstack.dataBinder.dotSet(a,d,b,!0)});var h={domReady:function(){},setData:function(){},data:d};$.extend(!0,this,h,a),this.ready=$.Deferred(),this.element=b,b.data("jController",this),this.startDataObserver=function(){c.data=ObjectObservable.create(c.data),ObjectObservable.observe(c.data,function(a){jstack.dataBinder.update()})},this.setDataArguments=[],this.setDataCall=function(){var a=this.setData.apply(this,this.setDataArguments);0==a?this.noRender=!0:"object"==$.type(a)&&a!==ctrl.data&&$.extend(this.data,a),this.startDataObserver()},this.render=function(a){if(!this.noRender){var b=this.element;b.data("jModel",this.data),b.attr("j-controller",this.name),Boolean(b.attr("j-view-append"))?b.append(a):b.html(a),this.domReady()}}},jstack.controllers[a.name];a=jstack.controllers[a]||jstack.controller($.extend(!0,{name:a},jstack.config.defaultController)),a=new a(b);var c=(a.name,[]);if(a.dependencies&&a.dependencies.length){var d=$.Deferred();$js(a.dependencies,function(){d.resolve()}),c.push(d)}var e=a.dependenciesData;if(e&&("function"==typeof e&&(a.dependenciesData=e=a.dependenciesData()),e&&e.length)){for(var f=[],g=0,h=e.length;g<h;g++){var i=e[g];if("function"==typeof i&&(i=i.call(a)),"object"==$.type(i)&&"abort"in i){var j=i;i=$.Deferred(),function(a){j.then(function(b){a.resolve(b)})}(i)}if(!("object"==$.type(i)&&"then"in i)){var j=i;i=$.Deferred(),i.resolve(j)}f.push(i)}var k=$.when.apply($,f).then(function(){for(var b=0,c=arguments.length;b<c;b++)a.setDataArguments.push(arguments[b])});c.push(k)}return $.when.apply($,c).then(function(){a.setDataCall(),a.ready.resolve()}),a},jstack.url=function(){var Url=function(){},recursiveArrayToObject=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(a[c]instanceof Array?b[c]=recursiveArrayToObject(a[c]):b[c]=a[c]);return b};return Url.prototype.params=new Array,Url.prototype.getQuery=function(a){var b=a,c=b.indexOf("?");return c==-1?"":(b=b.substr(c+1,b.length),c=b.indexOf("#"),c==-1?b:b.substr(0,c))},Url.prototype.getPath=function(a){var b=a.indexOf("?");return b==-1?a:a.substr(0,b)},Url.prototype.buildParamFromString=function(param){var p=decodeURIComponent(param),strpos=p.indexOf("=");if(strpos==-1)return""!==p&&(this.params[p]="",this.params.length++),!0;var name=p.substr(0,strpos),value=p.substr(strpos+1,p.length),openBracket=name.indexOf("["),closeBracket=name.indexOf("]");if(openBracket==-1||closeBracket==-1)return openBracket==-1&&closeBracket==-1||(name=name.replace(new RegExp("[\\[\\]]"),"_")),this.params[name]=value,!0;var matches=name.match(new RegExp("\\[.*?\\]","g"));name=name.substr(0,openBracket),p="this.params";var key=name;for(var i in matches)matches.hasOwnProperty(i)&&(p+="['"+key+"']",void 0!=eval(p)&&"object"==typeof eval(p)||eval(p+"= new Array();"),key=matches[i].substr(1,matches[i].length-2),""==key&&(key=eval(p).length));p+="['"+key+"']",eval(p+"= '"+value+"';")},Url.prototype.parseQuery=function(a){var b=a;b=b.replace(new RegExp("&"),"&"),this.params=new Array,this.params.length=0,b=b.split("&");for(var c=0;c<b.length;c++)this.buildParamFromString(b[c]);return recursiveArrayToObject(this.params)},Url.prototype.buildStringFromParam=function(a,b){var c="",d="";if(void 0!=b&&(c=b),"object"==typeof a)for(var e in a)d=a[e],e=""==c?e:"["+e+"]","object"==typeof d?this.buildStringFromParam(d,c+e):this.params[this.params.length]=c+e+"="+d},Url.prototype.buildQuery=function(a){return this.params=new Array,this.buildStringFromParam(a),this.params.join("&")},Url.prototype.getParams=function(a){return this.parseQuery(this.getQuery(a))},Url.prototype.getParamsFromHash=function(){return this.getParams(document.location.hash)},new Url}(),jstack.uniqid=function(a,b){"undefined"==typeof a&&(a="");var c,d=function(a,b){return a=parseInt(a,10).toString(16),b<a.length?a.slice(a.length-b):b>a.length?Array(1+(b-a.length)).join("0")+a:a};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,c=a,c+=d(parseInt((new Date).getTime()/1e3,10),8),c+=d(this.php_js.uniqidSeed,5),b&&(c+=(10*Math.random()).toFixed(8).toString()),c},jstack.isPositiveInteger=function(a){return 0===a%(!isNaN(parseFloat(a))&&0<=~~a)},jstack.isIntKey=function(a){return a>>>0===parseFloat(a)},jstack.arrayRemove=function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=b<0?a.length+b:b,Array.prototype.push.apply(a,d)},jstack.flatObservable=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];d=JSON.parse(JSON.stringify(d)),a.push(d)}return a},jstack.log=function(){console.log((new Error).stack.split("\n")[1]);var a=jstack.flatObservable.apply(jstack,arguments);console.log.apply(console,a)},String.prototype.camelCase=function(){return this.replace(/(\_[a-z])/g,function(a){return a.toUpperCase().replace("_","")})},String.prototype.camelCaseDash=function(){return this.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})},String.prototype.lcfirst=function(){return this.charAt(0).toLowerCase()+this.substr(1)},String.prototype.escapeRegExp=function(){return this.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},String.prototype.replaceAllRegExp=function(a,b){return this.replace(new RegExp(a,"g"),b)},String.prototype.replaceAll=function(a,b){return a=a.escapeRegExp(),this.replaceAllRegExp(a,b)},String.prototype.snakeCase=function(){return this.replace(/([A-Z])/g,function(a){return"_"+a.toLowerCase()})},String.prototype.snakeCaseDash=function(){return this.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},function(){function a(a,b){var c=[" ","\n","\r","\t","\f","\x0B"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join(""),d=0,e=0;for(a+="",b&&(c=(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1")),d=a.length,e=0;e<d;e++)if(c.indexOf(a.charAt(e))===-1){a=a.substring(e);break}for(d=a.length,e=d-1;e>=0;e--)if(c.indexOf(a.charAt(e))===-1){a=a.substring(0,e+1);break}return c.indexOf(a.charAt(0))===-1?a:""}function b(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1"):" \\s ";var c=new RegExp("^["+b+"]+","g");return(a+"").replace(c,"")}function c(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"\\$1"):" \\s ";var c=new RegExp("["+b+"]+$","g");return(a+"").replace(c,"")}String.prototype.trim=function(b){return a(this,b)},String.prototype.ltrim=function(a){return b(this,a)},String.prototype.rtrim=function(a){return c(this,a)}}(),String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.substr(1)},jstack.reflection={},jstack.reflection.arguments=function(f){var args=f.toString().match(/^\s*function\s+(?:\w*\s*)?\((.*?)\)\s*{/),r={};if(args&&args[1]){args=args[1],args=args.replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),args=args.trim().split(/\s*,\s*/);for(var i=0;i<args.length;i++){var arg=args[i],idf=arg.indexOf("=");idf===-1?r[arg]=void 0:r[arg.substr(0,idf)]=eval(arg.substr(idf+1).trim())}}return r},jstack.reflection.isCyclic=function(a){function b(a,g){if("object"==typeof a){if(e.has(a)){var h=d.indexOf(a),i=c.join(".")+"."+g,j=c.slice(0,h+1).join(".");return console.log("CIRCULAR: "+i+" = "+j+" = "+a),console.log(a),void(f=!0)}c.push(g),d.push(a),e.add(a);for(var k in a)a.hasOwnProperty(k)&&b(a[k],k);c.pop(),d.pop(),e["delete"](a)}}var c=[],d=[],e=new Set,f=!1;return b(a,"obj"),f},$.arrayCompare=function(a,b){return 0===$(a).not(b).get().length&&0===$(b).not(a).get().length},$.fn.attrStartsWith=function(a){var b={};return this.each(function(c){$.each(this.attributes,function(c,d){0===d.name.indexOf(a)&&(b[d.name]=d.value)})}),b},$.attrsToObject=function(a,b,c){c||(c={});var d=a.split("--");"undefined"==typeof c&&(c={});var e=c,f=d.length-1;return $.each(d,function(a,c){c=$.camelCase(c),a==f?e[c]=b:(e[c]||(e[c]={}),e=e[c])}),c},$.fn.changeVal=function(a){return $(this).val(a).trigger("change")},$.fn.childrenHeight=function(a,b,c){var d=bottomOffset=0;"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0),"undefined"==typeof c&&(c=!0);var e=this.children();return c&&(e=e.filter(":visible")),e.each(function(c,e){var f=$(e),g=f.offset().top,h=g+(a?f.outerHeight(b):f.height());g<d&&(d=g),h>bottomOffset&&(bottomOffset=h)}),bottomOffset-d-this.offset().top},$.fn.dataAttrConfig=function(a){a||(a="data-");var b=a.length,c=this.attrStartsWith(a),d={};return $.each(c,function(a,c){$.attrsToObject(a.substr(b),c,d)}),d},$.fn.findExclude=function(a,b,c){var d=$([]);return $(this).each(function(e,f){$(f).find(a).each(function(a,e){var g=$(e);c&&(g=g.parent());var h=g.closest(b);h[0]!=f&&h.length||(d=d.add(e))})}),d},$.fn.hasHorizontalScrollBar=function(){return!!this.get(0)&&this.get(0).scrollWidth>this.innerWidth()},$.fn.hasVerticalScrollBar=function(){return!!this.get(0)&&this.get(0).scrollHeight>this.innerHeight()},function(){var a={"nth-level":function(a,b){b=parseInt(b,10);var c=[],d=this;return this.each(function(){b+$(this).parents(a).length;d.find(a).each(function(){$(this).parents(a).length==b-1&&c.push(this)})}),$(c)}};$.fn.findOrig=$.fn.find,$.fn.find=function(b){if("string"==typeof b){var c,d=this;if($.each(a,function(e,f){var g=b.indexOf(":"+e);if(g!==-1){var h=e.length,i=b.substr(0,g),j=b.substr(g+h+2,b.length-g-h-3);return c=a[e].call(d,i,j),!1}}),c)return c}return this.findOrig(b)}}(),$.on=function(a,b,c){return $(document).on(a,b,c)},$.off=function(a,b,c){return $(document).off(a,b,c)},$.one=function(a,b,c){return $(document).one(a,b,c)},$.extend($.expr[":"],{scrollable:function(a){var b,c;return"scroll"==$(a).css("overflow")||"scroll"==$(a).css("overflowX")||"scroll"==$(a).css("overflowY")||((b=a.clientHeight<a.scrollHeight&&($.inArray($(a).css("overflowY"),["scroll","auto"])!=-1||$.inArray($(a).css("overflow"),["scroll","auto"])!=-1))||(c=a.clientWidth<a.scrollWidth&&($.inArray($(a).css("overflowX"),["scroll","auto"])!=-1||$.inArray($(a).css("overflow"),["scroll","auto"])!=-1)))},parents:function(a,b,c){return $(a).parents(c[3]).length<1},attrStartsWith:function(a,b,c){for(var d=0,e=a.attributes,f=e.length;d<f;d++)if(0===e[d].nodeName.toLowerCase().indexOf(c[3].toLowerCase()))return!0;return!1},attrEndsWith:function(a,b,c){for(var d=0,e=a.attributes,f=e.length;d<f;d++){var g=e[d].nodeName.toLowerCase(),h=c[3].toLowerCase();if(g.length>=h.length&&g.substr(g.length-h.length)===h)return!0}return!1},data:function(a,b,c){return!!$.data(a,c[3])}}),$.fn.removeClassPrefix=function(a){return this.each(function(b,c){var d=c.className.split(" ").filter(function(b){return 0!==b.lastIndexOf(a,0)});c.className=$.trim(d.join(" "))}),this},$.fn.requiredId=function(){var a=this.attr("id");return this.length>1?this.each(function(){$(this).requiredId()}):(a||(a=jstack.uniqid("uid-"),this.attr("id",a)),a)},$.fn.reverse=function(){return $(this.get().reverse())},$.fn.setVal=$.fn.val,$.fn.val=function(){var a=$.fn.setVal.apply(this,arguments);return arguments.length&&this.trigger("val"),a},function(){var a=function(a,b,c){var d=a.hasClass("select2-hidden-accessible");if(!a[0].hasAttribute("data-preselect")||d){var e=!1,f="option";if(a.children().each(function(a){var d=$(this);d.is("option")?d.val()==b?(d.prop("selected",!0),e=!0):c.push||d.prop("selected",!1):(0==a&&(f=d[0].tagName.toLowerCase()),d.attr("value")==b?(d.attr("selected","selected"),e=!0):c.push||d.removeAttr("selected"))}),!e&&c.addMissing&&"undefined"!=typeof b&&null!==b){var g,h;"object"==$.type(b)?(g=b.value,h=b.text):g=b,"undefined"==typeof h&&(h=g),g||(g=h),a.append("<"+f+' value="'+g+'" selected="selected">'+h+"</"+f+">")}d&&!c.preventValEvent&&a.trigger("change")}else if(c.push){var i=a.data("preselect")||[];"object"!=typeof i&&(i=[i]),i.indexOf(b)===-1&&i.push(b),a.data("preselect",i)}else a.data("preselect",b)};$.fn.populateInput=function(b,c){c=$.extend({addMissing:this.hasAttr("j-add-missing"),preventValEvent:!1,push:!1},c);var d;return d=c.preventValEvent?function(a,b){a.setVal(b)}:function(a,b){a.val(b)},this.each(function(){var e=$(this);if(!e.data("j:populate:prevent"))if(e.is("select, [j-select]"))if(b instanceof Array)if("[]"==e.attr("name").substr(-2)||e.hasAttr("multiple"))a(e,b,c);else for(var f=0,g=b.length;f<g;f++)a(e,b[f],c);else a(e,b,c);else if(e.is("textarea"))d(e,b);else switch(e.attr("type")){case"file":return;default:case"number":case"range":case"email":case"data":case"text":case"hidden":d(e,b);break;case"radio":e.length>=1&&$.each(e,function(a){var d=$(this).attr("value");singleVal=b;d===b?$(this).prop("checked",!0):c.push||$(this).prop("checked",!1)});break;case"checkbox":e.length>1?$.each(e,function(a){for(var d,e=$(this).attr("value"),f=void 0,g=0;g<b.length;g++)d=b[g],d===e&&(f=d);f?$(this).prop("checked",!0):c.push||$(this).prop("checked",!1)}):1==e.length&&($ctrl=e,b?$ctrl.prop("checked",!0):$ctrl.prop("checked",!1))}})},$.fn.populateForm=function(a,b){b=$.extend({not:!1,notContainer:!1},b);var c=this,d=function(a,d){null===d&&(d="");var e=c.find(':input[name="'+a+'"]');b.addMissing&&!e.length&&c.append('<input type="hidden" name="'+a+'" value="'+d+'">'),e.each(function(){var a=$(this);b.not&&a.is(b.not)||b.notContainer&&a.closest(b.notContainer).length||a.populateInput(d,b)})},e=function(a,d){var e=c.find(':input[name="'+a+'"],:input[name="'+a+'[]"]');e.each(function(){var a=$(this);b.not&&a.is(b.not)||b.notContainer&&a.closest(b.notContainer).length||a.populateInput(d,b)})},f=function(a,b){e(a,b),$.each(b,function(b,c){var e=a+"["+b+"]";"object"==typeof c&&null!=c?f(e,c):d(e,c)})};return $.each(a,function(a,b){"object"==typeof b&&null!=b?f(a,b):d(a,b)}),this},$.fn.populate=function(a,b){return this.each(function(){var c=$(this);c.is("form")?c.populateForm(a,b):c.populateInput(a,b)})},$.fn.populateReset=function(){return this.each(function(){var a=$(this);if(a.is("form"))a.find(":input[name]").populateReset();else{var b=a.prop("type");"checkbox"==b||"radio"==b?a.prop("checked",this.defaultChecked):a.populateInput(this.defaultValue,{preventValEvent:!0}),a.trigger("input")}})}}(),$.fn.outerHTML=function(){if(this.length){var a=$('<tmpl style="display:none;"></tmpl>'),b=($(this[0].cloneNode(!1)).html(this.html()).appendTo(a),a.html());return a.remove(),b}return null},$.fn.hasAttr=function(a){return this[0].hasAttribute(a)},$.fn.jComponentReady=function(a){var b=this,c=$.Deferred();c.then(a);var d=function(){var a=!0;b.each(function(){if(!$(this).data("j.component.loaded"))return a=!1,!1}),a&&c.resolve()};return this.on("j:component:loaded",function(){d()}),d(),c};var rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i,rcheckableType=/^(?:checkbox|radio)$/i;jQuery.fn.serializeArrayWithEmpty=function(){return this.map(function(){var a=jQuery.prop(this,"elements");return a?jQuery.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(a)&&(this.checked||!rcheckableType.test(a))}).map(function(a,b){var c=jQuery(this).val();return null==c&&(c=""),jQuery.isArray(c)?jQuery.map(c,function(a){return{name:b.name,value:a.replace(rCRLF,"\r\n")}}):{name:b.name,value:c.replace(rCRLF,"\r\n")}}).get()},function(a,b){if("function"==typeof define&&define.amd)define(["exports","jquery"],function(a,c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("jquery");b(exports,c)}else b(a,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(a,b){function c(a,c){function e(a,b,c){return a[b]=c,a}function f(a,b){for(var c,f=a.match(d.key);void 0!==(c=f.pop());)if(d.push.test(c)){var h=g(a.replace(/\[\]$/,""));b=e([],h,b)}else 0==c?b=e([],c,b):d.named.test(c)&&(b=e({},c,b));return b}function g(a){return void 0===n[a]&&(n[a]=0),n[a]++}function h(a){switch(b('[name="'+a.name+'"]',c).attr("type")){case"checkbox":return"on"===a.value||a.value;default:return a.value}}function i(b){if(!d.validate.test(b.name))return this;var c=f(b.name,h(b));return m=a.extend(!0,m,c),this}function j(b){if(!a.isArray(b))throw new Error("formSerializer.addPairs expects an Array");for(var c=0,d=b.length;c<d;c++)this.addPair(b[c]);return this}function k(){return m}function l(){return JSON.stringify(k())}var m={},n={};this.addPair=i,this.addPairs=j,this.serialize=k,this.serializeJSON=l}var d={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,named:/^[a-z0-9_]+$/i};return c.patterns=d,c.serializeObject=function(){return new c(b,this).addPairs(this.serializeArrayWithEmpty()).serialize()},c.serializeJSON=function(){return new c(b,this).addPairs(this.serializeArrayWithEmpty()).serializeJSON()},"undefined"!=typeof b.fn&&(b.fn.serializeObject=c.serializeObject,b.fn.serializeJSON=c.serializeJSON),a.FormSerializer=c,c}),$.prettifyHTML=function(a){if(a=$(a),a.parent().length>0&&a.parent().data("assign")?a.data("assign",a.parent().data("assign")+1):a.data("assign",1),a.children().length>0)a.children().each(function(){for(tbc="",i=0;i<$(this).parent().data("assign");i++)tbc+="\t";$(this).before("\n"+tbc),$(this).prepend("\t"),$(this).append("\n"+tbc),$.prettifyHTML($(this))});else{for(tbc="",i=0;i<a.parent().data("assign");i++)tbc+="\t";a.prepend("\n"+tbc)}return a.outerHTML()},$.walkTheDOM=function(a,b,c){if(!c&&b(a)===!1)return!1;for(var d=a.childNodes,e=0;e<d.length;e++)if(d[e]&&this.walkTheDOM(d[e],b)===!1)return!1;return(!c||b(a)!==!1)&&void 0},$.fn.walkTheDOM=function(a){var b=$();return this.each(function(){$.walkTheDOM(this,function(c){if(b.add(c),a)return a.call(c)})}),b},$.fn.replaceTagName=function(a){for(var b=[],c=this.length;c--;){for(var d=document.createElement(a),e=this[c],f=e.attributes,g=f.length-1;g>=0;g--){var h=f[g];d.setAttribute(h.name,h.value)}d.innerHTML=e.innerHTML,$(e).replaceWith(d),b[c]=d}return $(b)},$.fn.jModel=function(a,b){if(this.length<=1){var c=jstack.dataBinder.getScopeValue(this);return"undefined"!=typeof a?"undefined"==typeof c[a]?b:c[a]:c}var d=[];return this.each(function(){d.push($(this).jModel(a,b))}),d},$.fn.findComments=function(a){var b=[],c=Node.COMMENT_NODE;return this.each(function(){for(var d=0;d<this.childNodes.length;d++){var e=this.childNodes[d];e.nodeType!==c||a&&e.nodeValue.split(" ")[0]!=a?b.push.apply(b,$.fn.findComments.call($(e))):b.push(e)}}),$(b)},$.fn.findCommentsChildren=function(a){var b=[],c=Node.COMMENT_NODE;return this.each(function(){for(var d=0;d<this.childNodes.length;d++){var e=this.childNodes[d];e.nodeType===c&&e.nodeValue.split(" ")[0]==a?b.push.apply(b,$(e).commentChildren()):b.push.apply(b,$.fn.findCommentsChildren.call($(e),a))}}),$(b)},$.fn.commentChildren=function(){var a=[],b=Node.COMMENT_NODE;return this.each(function(){for(var c="/"+this.nodeValue.split(" ")[0],d=this.nextSibling;d&&(d.nodeType!==b||d.nodeValue!=c);)a.push(d),d=d.nextSibling}),$(a)},$.fn.parentComment=function(a){var b=Node.COMMENT_NODE,c=[];for(n=this[0].previousSibling;n;){if(n.nodeType===b&&n.nodeValue.split(" ")[0]===a){c.push(n);break}n=n.previousSibling}return $(c)},$.fn.dataCommentJSON=function(){if(arguments.length>1||"object"==$.type(arguments[0])){var a;if(arguments.length>1)a={},a[arguments[0]]=arguments[1];else var a=arguments[0];return this.each(function(){var b=this.nodeValue.split(" "),c=b.shift(),d=b.length?JSON.parse(b.join(" ")):{};$.extend(d,a),this.nodeValue=c+" "+JSON.stringify(d)})}var b=this[0].nodeValue.split(" ");b.shift();var c=b.length?JSON.parse(b.join(" ")):{};return arguments.length&&(c=c[arguments[0]]),c},function(){var a=0,b={};$.fn.removeDataComment=function(a){var c=this[0],d=c.nodeValue.split(" ");if(d[1]){var e=d[1];b[e]&&(a?b[e][a]&&delete b[e][a]:delete b[e])}},$.fn.dataComment=function(){if(arguments.length>1||"object"==$.type(arguments[0])){var c;if(arguments.length>1)c={},c[arguments[0]]=arguments[1];else var c=arguments[0];return this.each(function(){var a=$(this).dataComment();$.extend(a,c)})}var d,e=this[0],f=e.nodeValue.split(" "),g=f.shift();f.length?d=f[0]:(d=++a,e.nodeValue=g+" "+d),b[d]||(b[d]={});var h=b[d];return arguments.length&&(h=h[arguments[0]]),h}}(),$.fn.jData=function(a){if(this.length>1){var b=[];return this.each(function(){b.push($.fn.jData.call($(this),a))}),b}var b={},c=this[0];$.each(this.attrStartsWith("j-data-"),function(a,d){var e=jstack.dataBinder.textParser(d),f="string"==typeof e?jstack.dataBinder.getValueEval(c,e):d;b[a]=f});var d={};return $.each(b,function(a,b){$.attrsToObject(a.substr(7),b,d)}),a&&(d=jstack.dataBinder.dotGet(a,d)),d},function(){var a={},b={};jstack.getTemplate=function(c,d){if(d||(c=jstack.config.templatesPath+c),!b[c]){if($js.dev){var e=(new Date).getTime().toString(),f=c;f.indexOf("_t=")===-1&&(f+=(f.indexOf("?")<0?"?":"&")+"_t="+e)}b[c]=$.Deferred(),$.ajax({url:f,cache:!0,success:function(d){a[c]=d,b[c].resolve(a[c],c)}})}return b[c]}}(),jstack.component={},jstack.loader=function(a,b,c){$.on("j:load",a,function(){b.call(this)}),"function"==typeof c&&$.on("j:unload",a,function(){c.call(this)}),$(a).each(function(){b.call(this)})},jstack.loader(':attrStartsWith("j-on-")',function(){var a=$(this),b=a.attrStartsWith("j-on-");$.each(b,function(b,c){var d=b.substr(5);a.removeAttr(b),a.on(d,function(a){var d=jstack.dataBinder.getControllerObject(this);if("object"!=typeof d.methods||"function"!=typeof d.methods[c])throw new Error('Call to undefined method "'+c+'" by '+b+" and expected in controller "+d.name);var e=d.methods[c];if("function"==typeof e){var f=e.call(d,a,this);return f!==!1&&void 0}})})}),jstack.loader("[j-component]",function(){var a=this,b=$(a),c=b.attr("j-component");if(c&&!b.attr("j-component-handled")){b.attr("j-component-handled","true");var d=b.jData(),e=b.attr("j-params-data"),f=function(){var f,g=jstack.component[c];if(e){var h=[];h.push(a),f=new(Function.prototype.bind.apply(g,h))}else f=new g(a,d);b.data("j:component",f),f.deferred?f.deferred.then(function(){b.data("j.component.loaded",!0),b.trigger("j:component:loaded")}):(b.data("j.component.loaded",!0),b.trigger("j:component:loaded"))};jstack.component[c]?f():$js("jstack."+c,f)}},function(){var a=$(this).data("j:component");a&&"function"==typeof a.unload&&a.unload()}),jstack.route=function(a,b){var c=[],d={},e=function(a,b){this.name=b,this.path=a,this.keys=[],this.fns=[],this.params={},this.regex=f(this.path,this.keys,!1,!1)};e.prototype.addHandler=function(a){this.fns.push(a)},e.prototype.removeHandler=function(a){for(var b=0,c=this.fns.length;b<c;b++){var d=this.fns[b];if(a==d)return void this.fns.splice(b,1)}},e.prototype.run=function(a){for(var b=0,c=this.fns.length;b<c;b++){var d=this.fns[b].apply(this,a);"object"==$.type(d)&&"then"in d?d.then(function(){$(document).trigger("j:route:loaded")}):$(document).trigger("j:route:loaded")}},e.prototype.match=function(a,b){var c=this.regex.exec(a);if(!c)return!1;for(var d=1,e=c.length;d<e;++d){var f=this.keys[d-1],g="string"==typeof c[d]?decodeURIComponent(c[d]):c[d];f&&(this.params[f.name]=g),b.push(g)}return!0},e.prototype.toURL=function(a){var b=this.path;for(var c in a)b=b.replace("/:"+c,"/"+a[c]);if(b=b.replace(/\/:.*\?/g,"/").replace(/\?/g,""),b.indexOf(":")!=-1)throw new Error("missing parameters for url: "+b);return b};var f=function(a,b,c,d){return a instanceof RegExp?a:(a instanceof Array&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push({name:e,optional:!!g}),c=c||"",""+(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))},g=function(a,b){var f=a.split(" "),g=2==f.length?f[0]:null;a=2==f.length?f[1]:f[0],d[a]||(d[a]=new e(a,g),c.push(d[a])),c=c.sort(function(a,b){return"*"==a.path||c.indexOf(a)>c.indexOf(b)}),d[a].addHandler(b);
},h=function(a,c,d){if("function"==typeof c)g(a,c);else if("object"==typeof a)for(var e in a)g(e,a[e]);else if("undefined"==typeof c)h.navigate(a);else if("object"==typeof c){var f={};d&&$.extend(f,v()),$.extend(f,b.getParams(a),c);var i=b.buildQuery(f);i&&(i="?"+i),a=b.getPath(a),h.navigate(a+i)}};h.lookup=function(a,b){for(var d=0,e=c.length;d<e;d++){var f=c[d];if(f.name==a)return f.toURL(b)}},h.remove=function(a,b){var c=d[a];c&&c.removeHandler(b)},h.removeAll=function(){d={},c=[]},h.navigate=function(b,c){c=c||{};var d=c.silent||!1;d&&s(),setTimeout(function(){a.location.hash=b,d&&setTimeout(function(){r()},1)},1)};var i=function(){var b="",c=a.location.hash.substring(1),d=c.indexOf("#");return d!==-1&&(b=c.substr(d+1)),b},j=function(){var b=a.location.hash.substring(1),c=b.indexOf("#");return c!==-1&&(b=b.substr(0,c)),b},k=function(a,b){var c=[];return!!b.match(a,c)&&(b.run(c),!0)},l=function(a){for(var b=0,d=c.length;b<d;b++){var e=c[b];if(k(a,e))return}};h.load=l;var m,n=function(){var a=j();a!=m?(m=a,$(document).trigger("j:route:load"),l(m)):$(document).trigger("j:subroute:change")};h.reload=n;var o=function(b){var c=$(this),d=c.attr("href");if(d)return"/"+d==a.location.pathname?(b.preventDefault(),jstack.route(""),!1):void("##"==d.substr(0,2)&&(b.preventDefault(),q(d.substr(2))))},p=function(b){var c=b+"#"+i();a.location.hash=c},q=function(b){var c=m+"#"+b;a.location.hash=c},r=function(){a.addEventListener?a.addEventListener("hashchange",n,!1):a.attachEvent("onhashchange",n),$(document).on("click","a",o),h.reload()},s=function(){a.removeEventListener?a.removeEventListener("hashchange",n):a.detachEvent("onhashchange",n),$(document).off("click","a",o)};h.start=r,h.stop=s;var t=function(){return b.getQuery(j())},u=function(){return b.getPath(j())},v=function(){return b.getParams(j())},w=function(a){return v()[a]},x=function(){return b.getParams("?"+i())},y=function(a){return x()[a]};h.getHash=j,h.getHash2=i,h.getParams=v,h.getParam=w,h.getSubParams=x,h.getSubParam=y,h.getQuery=t,h.getPath=u,h.setMainHash=p,h.setSubHash=q;var z=document.getElementsByTagName("base")[0];if(z)h.baseHref=z.href;else{var A=window.location,B=A.pathname;B=B.split("/"),B.pop(),B=B.join("/")||"/";var C,D=A.username?A.username+(A.password?":"+A.password:"")+"@":"";C=A.port&&("https"==A.protocol&&"443"!=A.port||"80"!=A.port)?":"+A.port:"",h.baseHref=A.protocol+"//"+D+A.host+C+B}var E=a.location.href;E=E.split("/"),E=E[0]+"//"+E[2],E=h.baseHref.substr(E.length),h.basePath=E;var F=a.location.href.substr(h.baseHref.length),G=F.indexOf("#");return G>-1&&(F=F.substr(0,G)),h.baseLocation=F,h}(window,jstack.url),jstack.dataBinder=function(){var a=function(){};a.prototype={dotGet:function(a,b,c){return a.split(".").reduce(function(a,b){return"object"==typeof a&&null!==a&&"undefined"!=typeof a[b]?a[b]:c},b)},dotSet:function(a,b,c,d){if("object"==typeof b)return a.split(".").reduce(function(a,b,e,f){return f.length!=e+1?("object"==typeof a[b]&&null!==a[b]||(a[b]={}),a[b]):(d&&a[b]&&(c=a[b]),void(d&&a[b]||(a[b]=c)))},b),c},dotDel:function(a,b,c){a.split(".").reduce(function(a,b,c,d){if("object"==typeof a)return d.length!=c+1?a[b]:void("undefined"!=typeof a[b]&&delete a[b])},b)},getKey:function(a){return a.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").replace(/\[\]/g,".")},getValue:function(a,b,c){var d=this,e=d.getControllerData(a),f=d.getScoped(a,b);return d.dotGet(f,e,c)},getValueEval:function(a,b,c){var d=this,e=d.getScopeValue(a);e=JSON.parse(JSON.stringify(e)),"undefined"==typeof b?b="undefined":null===b?b="null":""==b.trim()?b="undefined":(b=b.replace(/[\r\t\n]/g,""),b=b.replace(/(?:^|\b)(this)(?=\b|$)/g,"$this"));var f;f=function(b){b||(b=1),b+=1;for(var c=a,e=0;e<b;e++)c=d.getParentScope(c);var f=d.getScopeValue(c);return f};var g=d.getControllerData(a),h=d.getControllerObject(a),i=["$model, $scope, $controller, $this, $default, $parent"],j=[g,e,h,a,c,f],k=[],l=[],m=[];$(a).is("[j-for-id]")&&m.push(a),$(a).parents("[j-for-id]").each(function(){m.push(this)});var n=function(a,b){e[a]=b};$(m).each(function(){var a=$(this),b=a.parentComment("j:for");if(b.length){var c=b.dataCommentJSON(),d=c.value;k.push(d);var e=a.data("j:for:data");l.push(e);var f=c.key,g=c.index;if(g&&n(g,a.index()+1),f){var h=a.attr("j-for-id");n(f,h)}}});for(var o=0,p=k.length;o<p;o++)i.push(k[o]);for(var o=0,p=l.length;o<p;o++)j.push(l[o]);i.push("with($scope){var $return = "+b+"; return typeof($return)=='undefined'?$default:$return;}");var q;try{var r=Function.apply(null,i);q=r.apply(null,j)}catch(s){if(jstack.config.debug){var t=[s.message,", expression: "+b,"element",a];a.nodeType==Node.COMMENT_NODE&&t.push($(a).parent().get()),console.warn.apply(console,t)}}return q},getAttrValueEval:function(a,b,c){var d=this,e=$(a).attr(b);return d.getValueEval(a,e,c)},getAttrValue:function(a,b,c){var d=this,e=$(a).attr(b);return d.getValue(a,e,c)},getScopeValue:function(a){var b=this,c=$(a).closest("[j-scope]");return c.length?b.getAttrValue(c,"j-scope",{}):b.getControllerData(a)},getScope:function(a){return $(a).parents("[j-scope]").map(function(){return $(this).attr("j-scope")}).get().reverse().join(".")},getScopedInput:function(a){var b=this,c=$(a),d=c.attr("name"),e=b.getKey(d);if("."==e.substr(-1)&&c.is(":checkbox")){var f,g=b.getParentScope(a);g.find(':checkbox[name="'+d+'"]').each(function(b){if(this===a)return f=b,!1}),e+=f}return b.getScoped(a,e)},getScoped:function(a,b){if("."===b.substr(0,1))return b.substr(1);var c=this.getScope(a);return c&&(c+="."),c+=b},getters:{select:function(a){if(a=$(a),a.children("option[value]").length)return a.val()},input:function(a){var b=$(a).prop("type");return"checkbox"==b||"radio"==b?$(a).prop("checked")?$(a).val():null:"file"==b?a.files:"submit"!=b?$(a).val():void 0},textarea:function(a){return $(a).val()},jselect:function(a){a=$(a);var b=a.hasAttr("multiple"),c=a.data("preselect");return c||(b&&(c=[]),a.children().each(function(){if($(this).hasAttr("selected")){var a=$(this).attr("value");if(!b)return c=a,!1;c.push(a)}})),c}},defaultGetter:function(a){return $(a).html()},getInputVal:function(a){var b=a.tagName.toLowerCase();"select"!=b&&$(a).hasAttr("j-select")&&(b="jselect");var c=this.getters[b]||this.defaultGetter;return c(a)},inputToModel:function(a,b){var c=$(a);if(!c.closest("[j-unscope]").length){var d=this,e=d.getControllerData(a),f=(c.attr("name"),function(){var f=d.getScopedInput(a);h!=g&&(g=h,c.populateInput(g,{preventValEvent:!0}));var i=d.dotGet(f,e);g=d.dotSet(f,e,g),c.trigger("j:input",[g]),"j:update"==b?c.trigger("j:input:update",[g]):c.trigger("j:input:user",[g]),i!==g&&c.trigger("j:change",[g,i])}),g=d.getInputVal(a),h=d.filter(a,g);"object"==typeof h&&null!==h&&"function"==typeof h.promise?h.then(function(a){h=a,f()}):f()}},validNodeEvent:function(a,b){if(a.nodeType==Node.TEXT_NODE&&a instanceof Text)return!1;if(b){var c=$(a);if(c.closest("[j-for]").length)return!1}return!0},watchersPrimary:0,watchers:{},addWatcher:function(a,b,c){c||(c=0),this.watchers[c]||(this.watchers[c]={}),this.watchers[c][++this.watchersPrimary]=b},checkRemoved:function(a){for(;a.parentNode;)a=a.parentNode;return $(a).data("j:if:state")!==!1},runWatchers:function(){var a=this;$.each(this.watchers,function(b,c){$.each(c,function(b,d){var e=d();e&&a.checkRemoved(e)&&delete c[b]})})},updateTimeout:null,updateDeferStateObserver:null,updateWait:100,update:function(){this.updateTimeout?(this.updateTimeout!==!0&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(this.runUpdate,this.updateWait)):(this.updateTimeout=!0,this.runUpdate())},runUpdate:function(a){var b=this;return this.updateDeferStateObserver?void this.updateDeferStateObserver.then(function(){b.update()}):(this.updateDeferStateObserver=$.Deferred(),this.runWatchers(),this.updateDeferStateObserver.resolve(),this.updateDeferStateObserver=!1,void(this.updateTimeout=!1))},loadMutations:function(a){var b=this,c=[],d=[];$.each(a,function(a,e){$.each(e.addedNodes,function(a,e){$.walkTheDOM(e,function(a){if(document.body.contains(a)){var e=$(a);if(a.nodeType==Node.TEXT_NODE&&a instanceof Text){var f=jstack.dataBinder.compilerText.call(a);return void(f&&c.push(function(){b.addWatcher(a,f,99),f()}))}a.nodeType==Node.ELEMENT_NODE&&($.each(b.compilers,function(c,d){if(e.is(d.selector)){var f=d.callback.call(a);f&&(a.hasAttribute("j-static")||b.addWatcher(a,f,c),f())}}),e.data("j:load:state")||(e.data("j:load:state",1),d.push(function(){setTimeout(function(){2!=e.data("j:load:state")&&(e.data("j:load:state",3),e.trigger("j:load"),e.data("j:load:state",3))},0)})))}})}),$.each(e.removedNodes,function(a,c){$.walkTheDOM(c,function(a){a.nodeType===Node.COMMENT_NODE&&b.checkRemoved(a)&&$(a).removeDataComment(),b.validNodeEvent(a,!0)&&setTimeout(function(){$(a).trigger("j:unload")},0)})})});for(var e=0,f=c.length;e<f;e++)c[e]();for(var e=0,f=d.length;e<f;e++)d[e]()},eventListener:function(){var a=this,b=new MutationObserver(function(b){a.loadMutations(b)});b.observe(document,{subtree:!0,childList:!0,attributes:!0,characterData:!0,attributeFilter:["name","value"]}),$(document.body).on("input change j:update",":input[name]",function(b){if("input"!=b.type||!$(this).is("select[name], input[name][type=checkbox], input[name][type=radio], input[name][type=file]")){var c=a.getInputVal(this);if("change"==b.type){var d=$(this).data("jHandledValue");if("undefined"!=typeof d&&c==d)return}$(this).data("jHandledValue",c),a.inputToModel(this,b.type)}})},filter:function(a,b){var c=this,d=c.getFilter(a);return"function"==typeof d&&(b=d(b)),b},getFilter:function(a){var b=this;a=$(a);var c=a.data("j-filter");if(!c){var d=a.attr("j-filter");if(d){var e=b.getValue(a,d);a.data("j-filter",e)}}return c},getControllerData:function(a){return this.getController(a).data("jModel")},getParentScope:function(a){var b=$(a).parent().closest("[j-scope]");return b.length||(b=this.getController(a)),b},getController:function(a){var b=$(a).closest("[j-controller]");if(!b.length){var b=$(document.body);b.data("jModel")||b.data("jModel",{});jstack.controller("",b)}return b.data("jController")||(b.data("jModel")||b.data("jModel",{}),jstack.controller("",b)),b},getControllerObject:function(a){return this.getController(a).data("jController")},compilers:[{selector:"[j-for]",callback:function(){var a=$(this),b=$("<!--j:for-->"),c=$("<!--/j:for-->");a.replaceWith(b),c.insertAfter(b);var d=a.attr("j-for");a.removeAttr("j-for"),d=d.trim();var e,f,g,h,i=new RegExp("(\\()(.*)(,)(.*)(,)(.*)(\\))(\\s+)(in)(\\s+)(.*)",["i"]),j=i.exec(d);if(null!=j)e=j[2].trim(),f=j[4].trim(),g=j[6],h=j[11].trim();else{var i=new RegExp("(\\()(.*)(,)(.*)(\\))(\\s+)(in)(\\s+)(.*)",["i"]),j=i.exec(d);if(null!=j)f=j[2].trim(),g=j[4],h=j[9].trim();else{var i=new RegExp("(.*)(\\s+)(in)(\\s+)(.*)",["i"]),j=i.exec(d);if(null==j)throw new Error("Malformed for clause: "+d);g=j[1],h=j[5].trim()}}var k,l=function(){return jstack.dataBinder.getValueEval(b,h)};b.dataCommentJSON({value:g,key:f,index:e});var m=function(){if(!document.body.contains(b[0]))return b[0];var d=l();if(k!==d){k=d;var e=[],f=b.commentChildren();$.each(d,function(b,d){var g=f.filter('[j-for-id="'+b+'"]');g.length||(g=a.clone(),g.attr("j-for-id",b),g.data("j:for:data",d),g.insertBefore(c)),e.push(b.toString())}),f.each(function(){var a=$(this).attr("j-for-id");e.indexOf(a)===-1&&$(this).remove()})}};return m}},{selector:"[j-if]",callback:function(){var a=$(this),b=$("<!--j:if-->");a.replaceWith(b),$("<!--/j:if-->").insertAfter(b);var c=a.attr("j-if");this.removeAttribute("j-if");var d,e=function(){return Boolean(jstack.dataBinder.getValueEval(b,c))},f=function(){if(!document.body.contains(b[0]))return b[0];var c=e();d!==c&&(d=c,a.data("j:if:state",c),c?a.insertAfter(b):a.detach())};return f}},{selector:"[j-switch]",callback:function(){var a=this,b=$(this),c=b.attr("j-switch");this.removeAttribute("j-switch");var d,e=b.find("[j-case],[j-case-default]"),f=function(){return Boolean(jstack.dataBinder.getValueEval(a,c))},g=function(){if(!document.body.contains(a))return a;var c=f();if(d!==c){d=c;var g=!1;e.filter("[j-case]").each(function(){var a=$(this),d=a.attr("j-case");d==c?(a.appendTo(b),g=!0):a.detach()}),e.filter("[j-case-default]").each(function(){var a=$(this);g?a.detach():a.appendTo(b)})}};return g}},{selector:"[j-href]",callback:function(){var a=this,b=$(this),c=b.attr("j-href");this.removeAttribute("j-href");var d=jstack.dataBinder.textParser(c);if("string"!=typeof d)return void b.attr("href",jstack.route.baseLocation+"#"+c);var e,f=function(){return jstack.dataBinder.getValueEval(a,d)},g=function(){if(!document.body.contains(a))return a;var c=f();e!==c&&(e=c,b.attr("href",jstack.route.baseLocation+"#"+c))};return g}},{selector:':attrStartsWith("j-model-")',callback:function(){var a=this,b=$(this),c=b.attrStartsWith("j-model-"),d={},e={};$.each(c,function(a,c){var e=jstack.dataBinder.textParser(c),f=a.substr(8);"string"==typeof e?d[a]=e:b.attr(f,c),b.removeAttr(a)});var f=function(){return document.body.contains(a)?void $.each(d,function(c,d){var f=jstack.dataBinder.getValueEval(a,d);e[c]!==f&&(e[c]=f,b.attr(c,f))}):a};return f}},{selector:':attrStartsWith("j-shortcut-model-")',callback:function(){var a=["selected","checked"],b=this,c=$(this),d=c.attrStartsWith("j-shortcut-model-"),e={},f={};$.each(d,function(a,b){e[a.substr(17)]=b,c.removeAttr(a)});var g=function(){return document.body.contains(b)?void $.each(e,function(d,e){var g=Boolean(jstack.dataBinder.getValueEval(b,e));f[d]!==g&&(f[d]=g,a.indexOf(d)!==-1?c.prop(d,g):g?c.attr(d,d):c.removeAttr(d))}):b};return g}},{selector:":input[name],[j-input],[j-select]",callback:function(){var a=this,b=$(this);if(!b.closest("[j-unscope]").length&&"file"!=b.attr("type")){var c,d=function(){var c=jstack.dataBinder.getInputVal(a),d=jstack.dataBinder.getKey(b.attr("name"));return jstack.dataBinder.getValue(a,d,c)},e=function(){if(!document.body.contains(a))return a;var e=d();c!==e&&(c=e,b.data("j:populate:prevent")||(b.populateInput(e,{preventValEvent:!0}),b.trigger("j:val",[e])))};return e}}}],compilerText:function(){if(this.textContent){var a=this.textContent.toString(),b=jstack.dataBinder.textParser(a);if("string"==typeof b){var c=$(this),d=$("<!--j:text-->"),e=$("<!--/j:text-->");c.replaceWith(d),e.insertAfter(d);var f,g=function(){return jstack.dataBinder.getValueEval(d,b)},h=function(){if(!document.body.contains(d[0]))return d[0];var a=g();f!==a&&(f=a,d.commentChildren().remove(),d.after(a))};return h}}},textParser:function(a){var b=/\{\{((?:.|\n)+?)\}\}/g;if(b.test(a)){for(var c,d,e=[],f=b.lastIndex=0;c=b.exec(a);){d=c.index,d>f&&e.push(JSON.stringify(a.slice(f,d)));var g=c[1].trim();e.push("("+g+")"),f=d+c[0].length}return f<a.length&&e.push(JSON.stringify(a.slice(f))),e.join("+")}}};var b=new a;return b.eventListener(),b}(),$.on("reset","form[j-scope]",function(){$(this).populateReset()}),function(a,b){var c=function(a,b){var c=a[b];return c!==Object[b]&&c!==Object.__proto__[b]&&c!==Array[b]&&c!==Array.__proto__[b]},d=function(b){for(var c=[],d=a.param(b).split("&"),e=0;e<d.length;e++){var f=d[e].split("="),g=null!==f[1]?decodeURIComponent(f[1]):"";c.push([decodeURIComponent(f[0]),g])}return c},e=function(b,c,d,f){d||(d="");for(var g in b)if(b.hasOwnProperty(g)){var h=d+g,i=b[g];if(i instanceof FileList){if(1==i.length)c[h]=i[0];else{c[h]=[];for(var j=0;j<i.length;j++)c[h].push(i[j])}delete b[g]}else i instanceof a?b[g]=i.jsonml():i instanceof HTMLCollection||i instanceof HTMLElement?b[g]=a(i).jsonml():"object"==typeof i&&e(i,c,h+"_",f+1)}},f=function(a){for(var b in a)c(a,b)&&("undefined"==typeof a[b]||null===a[b]?a[b]="":"object"==typeof a[b]&&(a[b]=f(a[b])));return a};b.ajax=function(){var b,c={};if(2==arguments.length?(b=arguments[1]||{},b.url=arguments[0]):b=arguments[0],b.data&&e(b.data,c),!a.isEmptyObject(c)){for(var g,h=new FormData,i=d(b.data),j=0;j<i.length;j++)h.append(i[j][0],i[j][1]);for(var k in c)if(c.hasOwnProperty(k)){var l=c[k];if(l instanceof Array)for(var j=0;j<l.length;j++)"undefined"!=typeof l[j]&&(h.append(k+"[]",l[j]),g=!0);else"undefined"!=typeof l&&(h.append(k,l),g=!0)}g&&(b.type="POST",b.processData=!1,b.contentType=!1,b.data=h)}return b.data=f(b.data),a.ajax(b)},b.post=function(a,c,d,e){return b.ajax({type:"POST",url:a,data:c,success:d,dataType:e})}}(jQuery,jstack),jstack.mvc=function(a){"string"==typeof arguments[0]&&(a={view:arguments[0],controller:"string"==typeof arguments[1]?arguments[1]:arguments[0]}),a.controller||(a.controller=a.view),a.target||(a.target=jstack.config.defaultTarget);var b=$(a.target),c=(a.controller,jstack.config.controllersPath+a.controller),d=$.Deferred();jstack.controllers[a.controller]?d.resolve():$js.onExists(c,d.resolve,d.resolve);var e=jstack.getTemplate(a.view+".jml"),f=$.Deferred();return d.then(function(){var c=jstack.controller(a.controller,b);$.when(e,c.ready).then(function(a){var d=a[0];c.render(d),f.resolve(b,c)})}),f},jstack.viewReady=function(a){if("string"==typeof arguments[0]){var b='[j-view="'+arguments[0]+'"]';a="object"==typeof arguments[1]?$(arguments[1]).find(b):$(b)}a=$(a);var c=a.data("jViewReady");return c||(c=$.Deferred(),a.data("jViewReady",c)),c},$.on("j:load","[j-view]:not([j-view-loaded])",function(){var a=$(this);a.attr("j-view-loaded",!0);var b,c=a.attr("j-view");b=a[0].hasAttribute("j-controller")?a.attr("j-controller"):c;var d=jstack.viewReady(this),e=jstack.mvc({view:c,controller:b,target:this});e.then(function(){setTimeout(function(){d.resolve()},0)})}),function(){jstack.app=function(a,b){b||(b=a.attr("j-app")),jstack.config.templatesPath+=b+"/",jstack.config.controllersPath+=b+"/",jstack.route("*",function(a){return a=jstack.url.getPath(a),jstack.mvc(a)})};var a=$("[j-app]");a.length&&jstack.app(a)}();