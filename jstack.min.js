jstackClass=function(){this.config={templatesPath:"view-js/",controllersPath:"controller-js/",defaultController:{},defaultTarget:"[j-app]",debug:$js.dev},this.controllers={}},jstackClass.prototype.extend=function(a,b){a.prototype=Object.create(b.prototype)},jstack=new jstackClass,function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.ObjectObservable=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],2:[function(a,b,c){var d=a("asap"),e=a("events"),f="__OBJECT_OBSERVABLE__PREFIX__"+new Date+"__",g={};g.create=function(a,b){function c(a){var b=function(b){l(b,a)};return k[a]=b,b}arguments.length||(a={});var b=Object.assign({},{clone:!1,recursive:!0},b),h=new e,i=[],j=!1,k=new WeakMap,l=function(a,b){var c=Object.assign({},a);b&&(c.path=a.path?b+"."+a.path:b),i.push(c),h.emit("change",c),j||(d(function(){h.emit("changes",i),j=!1,i=[]}),j=!0)},m=a;if(b.recursive)if(Array.isArray(a)){b.clone&&(m=[]);for(var n=0;n<a.length;++n){var o=a[n];"object"==typeof o&&o&&(g.isObservable(o)||(o=g.create(o),m[n]=o),g.observeInmediate(o,c(n)))}}else{b.clone&&(m={});for(var p in a)if(a.hasOwnProperty(p)){var o=a[p];"object"==typeof o&&o&&(g.isObservable(o)||(o=g.create(o),m[p]=o),g.observeInmediate(o,c(p)))}}return new Proxy(m,{get:function(a,b){return b===f?h:a[b]},set:function(a,d,e){var f=a[d],h=k[d];return f&&h&&g.unobserveInmediate(f,h),b.recursive&&"object"==typeof e&&e?(g.isObservable(e)||(e=g.create(e)),a[d]=e,g.observeInmediate(e,c(d))):a[d]=e,l({type:"set",target:a,key:d,value:e,old:f},d),e},deleteProperty:function(a,b){var c=a[b],d=k[b];return c&&d&&g.unobserveInmediate(c,d),c=Array.isArray(a)?a.splice(b,1):delete a[b],l({type:"deleteProperty",target:a,key:b},b),c},has:function(a,b){return f===b||b in a}})},g.isObservable=function(a){return"object"==typeof a&&a&&f in a},g.observe=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");return c.addListener("changes",b),b},g.once=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");return c.once("changes",b),b},g.unobserve=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");c.removeListener("changes",b)},g.observeInmediate=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");c.addListener("change",b)},g.unobserveInmediate=function(a,b){var c=a[f];if(!c)throw new Error("Object is not observable");return c.removeListener("change",b)},b.exports=g},{asap:3,events:1}],3:[function(a,b,c){"use strict";function d(){if(i.length)throw i.shift()}function e(a){var b;b=h.length?h.pop():new f,b.task=a,g(b)}function f(){this.task=null}var g=a("./raw"),h=[],i=[],j=g.makeRequestCallFromTimer(d);b.exports=e,f.prototype.call=function(){try{this.task.call()}catch(a){e.onerror?e.onerror(a):(i.push(a),j())}finally{this.task=null,h[h.length]=this}}},{"./raw":4}],4:[function(a,b,c){(function(a){"use strict";function c(a){h.length||(g(),i=!0),h[h.length]=a}function d(){for(;j<h.length;){var a=j;if(j+=1,h[a].call(),j>k){for(var b=0,c=h.length-j;b<c;b++)h[b]=h[b+j];h.length-=j,j=0}}h.length=0,j=0,i=!1}function e(a){var b=1,c=new l(a),d=document.createTextNode("");return c.observe(d,{characterData:!0}),function(){b=-b,d.data=b}}function f(a){return function(){function b(){clearTimeout(c),clearInterval(d),a()}var c=setTimeout(b,0),d=setInterval(b,50)}}b.exports=c;var g,h=[],i=!1,j=0,k=1024,l=a.MutationObserver||a.WebKitMutationObserver;g="function"==typeof l?e(d):f(d),c.requestFlush=g,c.makeRequestCallFromTimer=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2])(2)}),jstack.controller=function(a,b){if("object"==typeof a)return jstack.controllers[a.name]=function(b){var c=this;$.extend(!0,this,a),this.ready=$.Deferred(),this.element=b,b.data("jController",this),this.setDataArguments=[],this.setDataCall=function(){return this.setData.apply(this,this.setDataArguments)},this.dataBinder=function(){var a=this;return this.updateWait=100,this.updateDeferStateObserver=null,this.updateTimeout=null,this.runUpdate=function(b){return a.updateDeferStateObserver?void a.updateDeferStateObserver.then(function(){a.triggerUpdate(b)}):(a.updateDeferStateObserver=$.Deferred(),jstack.dataBinder.update(b),c.element.trigger("j:mutation"),a.updateDeferStateObserver.resolve(),a.updateDeferStateObserver=!1,void(this.updateTimeout=!1))},this.triggerUpdate=function(a){this.updateTimeout?(this.updateTimeout!==!0&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(this.runUpdate,this.updateWait)):(this.updateTimeout=!0,this.runUpdate(a))},this}()},jstack.controllers[a.name];a=jstack.controllers[a]||jstack.controller($.extend(!0,{name:a},jstack.config.defaultController)),a=new a(b);var c=(a.name,[]);if(a.dependencies&&a.dependencies.length){var d=$.Deferred();$js(a.dependencies,function(){d.resolve()}),c.push(d)}var e=a.dependenciesData;if(e&&("function"==typeof e&&(a.dependenciesData=e=a.dependenciesData()),e&&e.length)){for(var f=[],g=0,h=e.length;g<h;g++){var i=e[g];if("function"==typeof i&&(i=i.call(a)),"object"==$.type(i)&&"abort"in i){var j=i;i=$.Deferred(),function(a){j.then(function(b){a.resolve(b)})}(i)}if(!("object"==$.type(i)&&"then"in i)){var j=i;i=$.Deferred(),i.resolve(j)}f.push(i)}var k=$.when.apply($,f).then(function(){for(var b=0,c=arguments.length;b<c;b++)a.setDataArguments.push(arguments[b])});c.push(k)}return a.data=a.data||{},a.data=ObjectObservable.create(a.data),ObjectObservable.observe(a.data,function(b){a.dataBinder.triggerUpdate(a.element)}),$.when.apply($,c).then(function(){a.ready.resolve()}),a},jstack.url=function(){var Url=function(){},recursiveArrayToObject=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(a[c]instanceof Array?b[c]=recursiveArrayToObject(a[c]):b[c]=a[c]);return b};return Url.prototype.params=new Array,Url.prototype.getQuery=function(a){var b=a,c=b.indexOf("?");return c==-1?"":(b=b.substr(c+1,b.length),c=b.indexOf("#"),c==-1?b:b.substr(0,c))},Url.prototype.getPath=function(a){var b=a.indexOf("?");return b==-1?a:a.substr(0,b)},Url.prototype.buildParamFromString=function(param){var p=decodeURIComponent(param),strpos=p.indexOf("=");if(strpos==-1)return""!==p&&(this.params[p]="",this.params.length++),!0;var name=p.substr(0,strpos),value=p.substr(strpos+1,p.length),openBracket=name.indexOf("["),closeBracket=name.indexOf("]");if(openBracket==-1||closeBracket==-1)return openBracket==-1&&closeBracket==-1||(name=name.replace(new RegExp("[\\[\\]]"),"_")),this.params[name]=value,!0;var matches=name.match(new RegExp("\\[.*?\\]","g"));name=name.substr(0,openBracket),p="this.params";var key=name;for(var i in matches)matches.hasOwnProperty(i)&&(p+="['"+key+"']",void 0!=eval(p)&&"object"==typeof eval(p)||eval(p+"= new Array();"),key=matches[i].substr(1,matches[i].length-2),""==key&&(key=eval(p).length));p+="['"+key+"']",eval(p+"= '"+value+"';")},Url.prototype.parseQuery=function(a){var b=a;b=b.replace(new RegExp("&"),"&"),this.params=new Array,this.params.length=0,b=b.split("&");for(var c=0;c<b.length;c++)this.buildParamFromString(b[c]);return recursiveArrayToObject(this.params)},Url.prototype.buildStringFromParam=function(a,b){var c="",d="";if(void 0!=b&&(c=b),"object"==typeof a)for(var e in a)d=a[e],e=""==c?e:"["+e+"]","object"==typeof d?this.buildStringFromParam(d,c+e):this.params[this.params.length]=c+e+"="+d},Url.prototype.buildQuery=function(a){return this.params=new Array,this.buildStringFromParam(a),this.params.join("&")},Url.prototype.getParams=function(a){return this.parseQuery(this.getQuery(a))},Url.prototype.getParamsFromHash=function(){return this.getParams(document.location.hash)},new Url}(),jstack.uniqid=function(a,b){"undefined"==typeof a&&(a="");var c,d=function(a,b){return a=parseInt(a,10).toString(16),b<a.length?a.slice(a.length-b):b>a.length?Array(1+(b-a.length)).join("0")+a:a};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,c=a,c+=d(parseInt((new Date).getTime()/1e3,10),8),c+=d(this.php_js.uniqidSeed,5),b&&(c+=(10*Math.random()).toFixed(8).toString()),c},jstack.isPositiveInteger=function(a){return 0===a%(!isNaN(parseFloat(a))&&0<=~~a)},jstack.isIntKey=function(a){return a>>>0===parseFloat(a)},jstack.flatObservable=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];d=JSON.parse(JSON.stringify(d)),a.push(d)}return a},jstack.log=function(){console.log((new Error).stack.split("\n")[1]);var a=jstack.flatObservable.apply(jstack,arguments);console.log.apply(console,a)},String.prototype.camelCase=function(){return this.replace(/(\_[a-z])/g,function(a){return a.toUpperCase().replace("_","")})},String.prototype.camelCaseDash=function(){return this.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})},String.prototype.lcfirst=function(){return this.charAt(0).toLowerCase()+this.substr(1)},String.prototype.escapeRegExp=function(){return this.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},String.prototype.replaceAllRegExp=function(a,b){return this.replace(new RegExp(a,"g"),b)},String.prototype.replaceAll=function(a,b){return a=a.escapeRegExp(),this.replaceAllRegExp(a,b)},String.prototype.snakeCase=function(){return this.replace(/([A-Z])/g,function(a){return"_"+a.toLowerCase()})},String.prototype.snakeCaseDash=function(){return this.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},function(){function a(a,b){var c=[" ","\n","\r","\t","\f","\x0B"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join(""),d=0,e=0;for(a+="",b&&(c=(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1")),d=a.length,e=0;e<d;e++)if(c.indexOf(a.charAt(e))===-1){a=a.substring(e);break}for(d=a.length,e=d-1;e>=0;e--)if(c.indexOf(a.charAt(e))===-1){a=a.substring(0,e+1);break}return c.indexOf(a.charAt(0))===-1?a:""}function b(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"$1"):" \\s ";var c=new RegExp("^["+b+"]+","g");return(a+"").replace(c,"")}function c(a,b){b=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^:])/g,"\\$1"):" \\s ";var c=new RegExp("["+b+"]+$","g");return(a+"").replace(c,"")}String.prototype.trim=function(b){return a(this,b)},String.prototype.ltrim=function(a){return b(this,a)},String.prototype.rtrim=function(a){return c(this,a)}}(),String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.substr(1)},jstack.reflection={},jstack.reflection.arguments=function(f){var args=f.toString().match(/^\s*function\s+(?:\w*\s*)?\((.*?)\)\s*{/),r={};if(args&&args[1]){args=args[1],args=args.replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),args=args.trim().split(/\s*,\s*/);for(var i=0;i<args.length;i++){var arg=args[i],idf=arg.indexOf("=");idf===-1?r[arg]=void 0:r[arg.substr(0,idf)]=eval(arg.substr(idf+1).trim())}}return r},jstack.reflection.isCyclic=function(a){function b(a,g){if("object"==typeof a){if(e.has(a)){var h=d.indexOf(a),i=c.join(".")+"."+g,j=c.slice(0,h+1).join(".");return console.log("CIRCULAR: "+i+" = "+j+" = "+a),console.log(a),void(f=!0)}c.push(g),d.push(a),e.add(a);for(var k in a)a.hasOwnProperty(k)&&b(a[k],k);c.pop(),d.pop(),e["delete"](a)}}var c=[],d=[],e=new Set,f=!1;return b(a,"obj"),f},$.arrayCompare=function(a,b){return 0===$(a).not(b).get().length&&0===$(b).not(a).get().length},$.fn.attrStartsWith=function(a){var b={};return this.each(function(c){$.each(this.attributes,function(c,d){0===d.name.indexOf(a)&&(b[d.name]=d.value)})}),b},$.attrsToObject=function(a,b,c){c||(c={});var d=a.split("--");"undefined"==typeof c&&(c={});var e=c,f=d.length-1;return $.each(d,function(a,c){c=$.camelCase(c),a==f?e[c]=b:(e[c]||(e[c]={}),e=e[c])}),c},$.fn.changeVal=function(a){return $(this).val(a).trigger("change")},$.fn.childrenHeight=function(a,b,c){var d=bottomOffset=0;"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0),"undefined"==typeof c&&(c=!0);var e=this.children();return c&&(e=e.filter(":visible")),e.each(function(c,e){var f=$(e),g=f.offset().top,h=g+(a?f.outerHeight(b):f.height());g<d&&(d=g),h>bottomOffset&&(bottomOffset=h)}),bottomOffset-d-this.offset().top},$.fn.dataAttrConfig=function(a){a||(a="data-");var b=a.length,c=this.attrStartsWith(a),d={};return $.each(c,function(a,c){$.attrsToObject(a.substr(b),c,d)}),d},$.fn.findExclude=function(a,b,c){var d=$([]);return $(this).each(function(e,f){$(f).find(a).each(function(a,e){var g=$(e);c&&(g=g.parent());var h=g.closest(b);h[0]!=f&&h.length||(d=d.add(e))})}),d},$.fn.hasHorizontalScrollBar=function(){return!!this.get(0)&&this.get(0).scrollWidth>this.innerWidth()},$.fn.hasVerticalScrollBar=function(){return!!this.get(0)&&this.get(0).scrollHeight>this.innerHeight()},function(){var a={"nth-level":function(a,b){b=parseInt(b,10);var c=[],d=this;return this.each(function(){b+$(this).parents(a).length;d.find(a).each(function(){$(this).parents(a).length==b-1&&c.push(this)})}),$(c)}};$.fn.findOrig=$.fn.find,$.fn.find=function(b){if("string"==typeof b){var c,d=this;if($.each(a,function(e,f){var g=b.indexOf(":"+e);if(g!==-1){var h=e.length,i=b.substr(0,g),j=b.substr(g+h+2,b.length-g-h-3);return c=a[e].call(d,i,j),!1}}),c)return c}return this.findOrig(b)}}(),$.on=function(a,b,c){return $(document).on(a,b,c)},$.off=function(a,b,c){return $(document).off(a,b,c)},$.one=function(a,b,c){return $(document).one(a,b,c)},$.extend($.expr[":"],{scrollable:function(a){var b,c;return"scroll"==$(a).css("overflow")||"scroll"==$(a).css("overflowX")||"scroll"==$(a).css("overflowY")||((b=a.clientHeight<a.scrollHeight&&($.inArray($(a).css("overflowY"),["scroll","auto"])!=-1||$.inArray($(a).css("overflow"),["scroll","auto"])!=-1))||(c=a.clientWidth<a.scrollWidth&&($.inArray($(a).css("overflowX"),["scroll","auto"])!=-1||$.inArray($(a).css("overflow"),["scroll","auto"])!=-1)))},parents:function(a,b,c){return $(a).parents(c[3]).length<1},attrStartsWith:function(a,b,c){for(var d=0,e=a.attributes,f=e.length;d<f;d++)if(0===e[d].nodeName.toLowerCase().indexOf(c[3].toLowerCase()))return!0;return!1},attrEndsWith:function(a,b,c){for(var d=0,e=a.attributes,f=e.length;d<f;d++){var g=e[d].nodeName.toLowerCase(),h=c[3].toLowerCase();if(g.length>=h.length&&g.substr(g.length-h.length)===h)return!0}return!1},data:function(a,b,c){return!!$.data(a,c[3])}}),$.fn.removeClassPrefix=function(a){return this.each(function(b,c){var d=c.className.split(" ").filter(function(b){return 0!==b.lastIndexOf(a,0)});c.className=$.trim(d.join(" "))}),this},$.fn.requiredId=function(){var a=this.attr("id");return this.length>1?this.each(function(){$(this).requiredId()}):(a||(a=jstack.uniqid("uid-"),this.attr("id",a)),a)},$.fn.reverse=function(){return $(this.get().reverse())},$.fn.setVal=$.fn.val,$.fn.val=function(){var a=$.fn.setVal.apply(this,arguments);return arguments.length&&this.trigger("val"),a},$.fn.populateInput=function(a,b){b=$.extend({addMissing:!1,preventValEvent:!1,push:!1},b);var c;c=b.preventValEvent?function(a,b){a.setVal(b)}:function(a,b){a.val(b)};var d=function(a,c){var d=a.hasClass("select2-hidden-accessible");if(!a[0].hasAttribute("data-preselect")||d){var e=!1;if($("option",a).each(function(){$(this).val()==c?($(this).prop("selected",!0),e=!0):b.push||$(this).prop("selected",!1)}),!e&&b.addMissing){var f,g;"object"==typeof c?(f=c.value,g=c.text):f=c,"undefined"==typeof g&&(g=f),f||(f=g),a.append('<option value="'+f+'" selected="selected">'+g+"</option>")}d&&!b.preventValEvent&&a.trigger("change")}else if(b.push){var h=a.data("preselect")||[];"object"!=typeof h&&(h=[h]),h.indexOf(c)===-1&&h.push(c),a.data("preselect",h)}else a.data("preselect",c)};return this.each(function(){var e=$(this);if(!e.data("j:populate:prevent"))if(e.is("select"))if(a instanceof Array)if("[]"==e.attr("name").substr(-2)||e.prop("multiple"))d(e,a);else for(var f=0,g=a.length;f<g;f++)d(e,a[f]);else d(e,a);else if(e.is("textarea"))c(e,a);else switch(e.attr("type")){case"file":return;default:case"number":case"range":case"email":case"data":case"text":case"hidden":c(e,a);break;case"radio":e.length>=1&&$.each(e,function(c){var d=$(this).attr("value");singleVal=a;d===a?$(this).prop("checked",!0):b.push||$(this).prop("checked",!1)});break;case"checkbox":e.length>1?$.each(e,function(c){for(var d,e=$(this).attr("value"),f=void 0,g=0;g<a.length;g++)d=a[g],d===e&&(f=d);f?$(this).prop("checked",!0):b.push||$(this).prop("checked",!1)}):1==e.length&&($ctrl=e,a?$ctrl.prop("checked",!0):$ctrl.prop("checked",!1))}})},$.fn.populateForm=function(a,b){b=$.extend({addMissing:!1,not:!1,notContainer:!1},b);var c=this,d=function(a,d){null===d&&(d="");var e=c.find(':input[name="'+a+'"]');b.addMissing&&!e.length&&c.append('<input type="hidden" name="'+a+'" value="'+d+'">'),e.each(function(){var a=$(this);b.not&&a.is(b.not)||b.notContainer&&a.closest(b.notContainer).length||a.populateInput(d,b)})},e=function(a,d){var e=c.find(':input[name="'+a+'"],:input[name="'+a+'[]"]');e.each(function(){var a=$(this);b.not&&a.is(b.not)||b.notContainer&&a.closest(b.notContainer).length||a.populateInput(d,b)})},f=function(a,b){e(a,b),$.each(b,function(b,c){var e=a+"["+b+"]";"object"==typeof c&&null!=c?f(e,c):d(e,c)})};return $.each(a,function(a,b){"object"==typeof b&&null!=b?f(a,b):d(a,b)}),this},$.fn.populate=function(a,b){return this.each(function(){var c=$(this);c.is("form")?c.populateForm(a,b):c.populateInput(a,b)})},$.fn.populateReset=function(){return this.each(function(){var a=$(this);if(a.is("form"))a.find(":input[name]").populateReset();else{var b=a.prop("type");"checkbox"==b||"radio"==b?a.prop("checked",this.defaultChecked):a.populateInput(this.defaultValue,{preventValEvent:!0}),a.trigger("input")}})},$.fn.outerHTML=function(){if(this.length){var a=$('<tmpl style="display:none;"></tmpl>'),b=($(this[0].cloneNode(!1)).html(this.html()).appendTo(a),a.html());return a.remove(),b}return null},$.fn.loadJml=function(a,b){var c=this;return jstack.jml(a,b).then(function(a){c.append(a)})},$.fn.hasAttr=function(a){return this[0].hasAttribute(a)},$.fn.jComponentReady=function(a){var b=this,c=$.Deferred();c.then(a);var d=function(){var a=!0;b.each(function(){if(!$(this).data("j.component.loaded"))return a=!1,!1}),a&&c.resolve()};return this.on("j:component:loaded",function(){d()}),d(),c},function(a,b){if("function"==typeof define&&define.amd)define(["exports","jquery"],function(a,c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("jquery");b(exports,c)}else b(a,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(a,b){function c(a,c){function e(a,b,c){return a[b]=c,a}function f(a,b){for(var c,f=a.match(d.key);void 0!==(c=f.pop());)if(d.push.test(c)){var h=g(a.replace(/\[\]$/,""));b=e([],h,b)}else 0==c?b=e([],c,b):d.named.test(c)&&(b=e({},c,b));return b}function g(a){return void 0===n[a]&&(n[a]=0),n[a]++}function h(a){switch(b('[name="'+a.name+'"]',c).attr("type")){case"checkbox":return"on"===a.value||a.value;default:return a.value}}function i(b){if(!d.validate.test(b.name))return this;var c=f(b.name,h(b));return m=a.extend(!0,m,c),this}function j(b){if(!a.isArray(b))throw new Error("formSerializer.addPairs expects an Array");for(var c=0,d=b.length;c<d;c++)this.addPair(b[c]);return this}function k(){return m}function l(){return JSON.stringify(k())}var m={},n={};this.addPair=i,this.addPairs=j,this.serialize=k,this.serializeJSON=l}var d={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,named:/^[a-z0-9_]+$/i};return c.patterns=d,c.serializeObject=function(){return new c(b,this).addPairs(this.serializeArray()).serialize()},c.serializeJSON=function(){return new c(b,this).addPairs(this.serializeArray()).serializeJSON()},"undefined"!=typeof b.fn&&(b.fn.serializeObject=c.serializeObject,b.fn.serializeJSON=c.serializeJSON),a.FormSerializer=c,c}),$.prettifyHTML=function(a){if(a=$(a),a.parent().length>0&&a.parent().data("assign")?a.data("assign",a.parent().data("assign")+1):a.data("assign",1),a.children().length>0)a.children().each(function(){for(tbc="",i=0;i<$(this).parent().data("assign");i++)tbc+="\t";$(this).before("\n"+tbc),$(this).prepend("\t"),$(this).append("\n"+tbc),$.prettifyHTML($(this))});else{for(tbc="",i=0;i<a.parent().data("assign");i++)tbc+="\t";a.prepend("\n"+tbc)}return a.outerHTML()},jstack.template={},jstack.template.templateVarSubstitutions={},function(w,j){var separatorStart="<%",separatorEnd="%>",separatorStartE="<%",separatorEndE="%>",cache={},reg1=eval("/'(?=[^"+separatorEndE+"]*"+separatorEndE+")/g"),reg2=eval("/"+separatorStartE+"=(.+?)"+separatorEndE+"/g");j.template.parse=function(a,b,c){var d;if(c&&cache[c])d=cache[c];else{var e=j.template.templateVarSubstitutions;a=a.html();for(var f in e)e.hasOwnProperty(f)&&(a=a.replace(new RegExp(f,"g"),separatorStart+e[f]+separatorEnd));var g=jstack.config.debug?'console.warn(tmplException.message+" in $1", "context : "+tmplString+" $1",tmplObj);':"",h=a.replace(/[\r\t\n]/g," ").replace(reg1,"\t").split("'").join("\\'").split("\t").join("'").replace(reg2,"'; try{ tmplString += $1 }catch(tmplException){ "+g+" }; tmplString += '").split(separatorStart).join("';").split(separatorEnd).join("tmplString += '"),i="var tmplString=''; with(tmplObj){ tmplString += '"+h+"';} return tmplString;";try{d=new Function("tmplObj",i),c&&(cache[c]=d)}catch(k){jstack.config.debug&&(console.log(k),console.log(i),console.log(a))}}return b?d(b):d}}(window,jstack),jstack.template.compile=function(a,b,c){var d=$.Deferred();return $.when.apply($,jstack.template.directiveCompile(a,c)).then(function(){var c=function(c){return jstack.template.directiveCompileLoaded($("<tmpl>"+jstack.template.parse(a,c,b)+"</tmpl>")).contents()};d.resolve(c)}),d},jstack.template.directives={},jstack.template.directive=function(a,b){return b&&(jstack.template.directives[a]=b),jstack.template.directives[a]},jstack.template.directiveCompileLoaded=function(a){return a.find("*").each(function(){var a=$(this);$.each(this.attributes,function(){var b=this.name;"j-loaded-"==b.substr(0,9)&&(a.attr(b.substr(9),this.value),a.removeAttr(b))})}),a},jstack.template.directiveCompile=function(a,b){var c=[];return $.each(jstack.template.directives,function(d,e){a.find("[j-"+d+"],"+d+"[j]").each(function(){var a=this.tagName==d.toUpperCase(),f=$(this),g=a?f.attr("j"):f.attr("j-"+d),h=e(g,f,b);h&&c.push(h),a?(f.removeAttr("j"),h?h.then(function(){f.replaceWith(f.html())}):f.replaceWith(f.html())):f.removeAttr("j-"+d)})}),c},jstack.template.jmlInject=function(a,b,c){return a.each(function(){var a=$(this),d=jstack.uniqid("tmpl");jstack.template.templateVarSubstitutions[d]=c,a[b](d)})},jstack.template.directive("foreach",function(a,b){var c;a.indexOf(" as ")!==-1?(c=a.split(" as "),jstack.template.jmlInject(b,"before","$.each("+c[0]+", function(i,"+c[1]+"){")):(c=a.split(" in "),jstack.template.jmlInject(b,"before","$.each("+c[1]+", function("+c[0]+"){")),jstack.template.jmlInject(b,"after","});")}),jstack.template.directive("src",function(a,b){b.attr("j-loaded-src",a)}),jstack.template.directive("include",function(a,b,c){var d=a.split(".").pop(),e=c+a;"jml"!=d&&(e+=".jml");var f=$.Deferred();return jstack.template.get(e).then(function(a){var d=$("<tmpl>"+a+"</tmpl>");$.when.apply($,jstack.template.directiveCompile(d,c)).then(function(){b.html(d.contents()),f.resolve()})}),f}),jstack.template.directive("extend",function(a,b,c){var d=c+a,e=a.split(".").pop();"jml"!=e&&"xjml"!=e&&(d+=".xjml");var f=$.Deferred();return jstack.template.get(d).then(function(a){var d=$("<tmpl>"+a+"</tmpl>");$.when.apply($,jstack.template.directiveCompile(d,c)).then(function(){b.find(">*").each(function(){var a=$(this),b=a.attr("selector");b||(b=a.attr("j"));var c=this.tagName.toLowerCase(),e=a.contents(),f=d.find(b);e.length?f[c](a.contents()):f[c]()}),b.replaceWith(d.contents()),f.resolve()})}),f}),function(){var a={},b={};jstack.template.get=function(c){if(!b[c]){if($js.dev){var d=(new Date).getTime().toString(),e=c;e.indexOf("_t=")===-1&&(e+=(e.indexOf("?")<0?"?":"&")+"_t="+d)}b[c]=$.Deferred(),$.ajax({url:e,cache:!0,success:function(d){for(var e={},f="",g=d.split("<%"),h=0,i=g.length;h<i;h++)if(h)for(var j=g[h].split("%>"),k=0,l=j.length;k<l;k++)if(k%2)f+=j[k];else{var m=jstack.uniqid("tmpl");f+=m,e[m]=j[k]}else f+=g[h];$.extend(jstack.template.templateVarSubstitutions,e),a[c]=f,b[c].resolve(a[c],c)}})}return b[c]}}(),jstack.jml=function(a,b){var c=a,d=$.Deferred(),e=a.split("/");return e.pop(),e=e.join("/")+"/",e=jstack.config.templatesPath+e,a=jstack.config.templatesPath+a,b||(b={}),jstack.template.get(a).then(function(a){var f=$("<tmpl>"+a+"</tmpl>");jstack.template.compile(f,c,e).then(function(a){d.resolve(a(b))})}),d},function(){jstack.component={};var a=function(){var a=this,b=$(a),c=b.attr("j-component");if(c&&!b.attr("j-component-handled")){b.attr("j-component-handled","true");var d=b.dataAttrConfig("j-data-"),e=b.attr("j-params-data"),f=function(){var f,g=jstack.component[c];if(e){var h=[];h.push(a),f=new(Function.prototype.bind.apply(g,h))}else f=new g(a,d);b.data("j:component",f),f.deferred?f.deferred.then(function(){b.data("j.component.loaded",!0),b.trigger("j:component:loaded")}):(b.data("j.component.loaded",!0),b.trigger("j:component:loaded"))};jstack.component[c]?f():$js("jstack."+c,f)}},b=function(){var a=this,b=$(a).attr("jquery-component"),c=$(a).dataAttrConfig("j-data-"),d=$(a).attr("j-params-data"),e=[];if(d){var f=[];for(var g in c)c.hasOwnProperty(g)&&f.push(g);f.sort();for(var h=0,i=f.length;h<i;h++)e.push(c[f[h]])}else $.isEmptyObject(c)||e.push(c);var j=function(){$(a).data("j:component",$.fn[b].apply($(a),e))};$.fn[b]?j():$js("jstack.jquery."+b,j)};$.on("j:load","[j-component]",a),$.on("j:load","[jquery-component]",b),$.on("j:unload","[j-component]",function(){var a=$(this).data("j:component");a&&"function"==typeof a.unload&&a.unload()}),$("[j-component]").each(function(){$(this).data("j:component")||a.call(this)}),$("[jquery-component]").each(function(){$(this).data("j:component")||b.call(this)}),jstack.loader=function(a,b,c){$.on("j:load",a,function(){b.call(this)}),"function"==typeof c&&$.on("j:unload",a,function(){c.call(this)}),$(a).each(function(){b.call(this)})},jstack.preloader={"[j-for]":function(){jstack.dataBinder.loaders.jFor.call(this),jstack.dataBinder.loaders.jForList.call($(this).data("parent")[0])},"[j-for-list]":function(){jstack.dataBinder.loaders.jForList.call(this)},"[j-if]":function(){jstack.dataBinder.loaders.jIf.call(this)},"[j-switch]":function(){jstack.dataBinder.loaders.jSwitch.call(this)},"[j-href]":function(){jstack.dataBinder.loaders.jHref.call(this)},":data(j-var)":function(){jstack.dataBinder.loaders.jVar.call(this)},':attrStartsWith("j-var-")':function(){jstack.dataBinder.loaders.jVarAttr.call(this)},':attrStartsWith("j-model-")':function(){jstack.dataBinder.loaders.jModelAttr.call(this)},':attrStartsWith("j-data-")':function(){jstack.dataBinder.loaders.jDataAttr.call(this)},':attrStartsWith("j-shortcut-model-")':function(){jstack.dataBinder.loaders.jShrotcutModelAttr.call(this)},":input[name]":function(){$(this).data("j:firstload")||($(this).data("j:firstload",!0),jstack.dataBinder.inputToModel(this,"j:default",!0)),jstack.dataBinder.loaders.inputWithName.call(this)}},jstack.loader(':attrStartsWith("j-on-")',function(){var a=$(this),b=a.attrStartsWith("j-on-");$.each(b,function(b,c){var d=b.substr(5);a.removeAttr(b),a.on(d,function(a){var d=jstack.dataBinder.getControllerObject(this);if("object"!=typeof d.methods||"function"!=typeof d.methods[c])throw new Error('Call to undefined method "'+c+'" by '+b+" and expected in controller "+d.name);var e=d.methods[c];if("function"==typeof e){var f=e.call(d,a,this);return f!==!1&&void 0}})})})}(),jstack.route=function(a,b){var c=[],d={},e=function(a,b){this.name=b,this.path=a,this.keys=[],this.fns=[],this.params={},this.regex=f(this.path,this.keys,!1,!1)};e.prototype.addHandler=function(a){this.fns.push(a)},e.prototype.removeHandler=function(a){
for(var b=0,c=this.fns.length;b<c;b++){var d=this.fns[b];if(a==d)return void this.fns.splice(b,1)}},e.prototype.run=function(a){for(var b=0,c=this.fns.length;b<c;b++){var d=this.fns[b].apply(this,a);"object"==$.type(d)&&"then"in d?d.then(function(){$(document).trigger("j:route:loaded")}):$(document).trigger("j:route:loaded")}},e.prototype.match=function(a,b){var c=this.regex.exec(a);if(!c)return!1;for(var d=1,e=c.length;d<e;++d){var f=this.keys[d-1],g="string"==typeof c[d]?decodeURIComponent(c[d]):c[d];f&&(this.params[f.name]=g),b.push(g)}return!0},e.prototype.toURL=function(a){var b=this.path;for(var c in a)b=b.replace("/:"+c,"/"+a[c]);if(b=b.replace(/\/:.*\?/g,"/").replace(/\?/g,""),b.indexOf(":")!=-1)throw new Error("missing parameters for url: "+b);return b};var f=function(a,b,c,d){return a instanceof RegExp?a:(a instanceof Array&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push({name:e,optional:!!g}),c=c||"",""+(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))},g=function(a,b){var f=a.split(" "),g=2==f.length?f[0]:null;a=2==f.length?f[1]:f[0],d[a]||(d[a]=new e(a,g),c.push(d[a])),c=c.sort(function(a,b){return"*"==a.path||c.indexOf(a)>c.indexOf(b)}),d[a].addHandler(b)},h=function(a,c,d){if("function"==typeof c)g(a,c);else if("object"==typeof a)for(var e in a)g(e,a[e]);else if("undefined"==typeof c)h.navigate(a);else if("object"==typeof c){var f={};d&&$.extend(f,v()),$.extend(f,b.getParams(a),c);var i=b.buildQuery(f);i&&(i="?"+i),a=b.getPath(a),h.navigate(a+i)}};h.lookup=function(a,b){for(var d=0,e=c.length;d<e;d++){var f=c[d];if(f.name==a)return f.toURL(b)}},h.remove=function(a,b){var c=d[a];c&&c.removeHandler(b)},h.removeAll=function(){d={},c=[]},h.navigate=function(b,c){c=c||{};var d=c.silent||!1;d&&s(),setTimeout(function(){a.location.hash=b,d&&setTimeout(function(){r()},1)},1)};var i=function(){var b="",c=a.location.hash.substring(1),d=c.indexOf("#");return d!==-1&&(b=c.substr(d+1)),b},j=function(){var b=a.location.hash.substring(1),c=b.indexOf("#");return c!==-1&&(b=b.substr(0,c)),b},k=function(a,b){var c=[];return!!b.match(a,c)&&(b.run(c),!0)},l=function(a){for(var b=0,d=c.length;b<d;b++){var e=c[b];if(k(a,e))return}};h.load=l;var m,n=function(){var a=j();a!=m?(m=a,$(document).trigger("j:route:load"),l(m)):$(document).trigger("j:subroute:change")};h.reload=n;var o=function(b){var c=$(this),d=c.attr("href");if(d)return"/"+d==a.location.pathname?(b.preventDefault(),jstack.route(""),!1):void("##"==d.substr(0,2)&&(b.preventDefault(),q(d.substr(2))))},p=function(b){var c=b+"#"+i();a.location.hash=c},q=function(b){var c=m+"#"+b;a.location.hash=c},r=function(){a.addEventListener?a.addEventListener("hashchange",n,!1):a.attachEvent("onhashchange",n),$(document).on("click","a",o),h.reload()},s=function(){a.removeEventListener?a.removeEventListener("hashchange",n):a.detachEvent("onhashchange",n),$(document).off("click","a",o)};h.start=r,h.stop=s;var t=function(){return b.getQuery(j())},u=function(){return b.getPath(j())},v=function(){return b.getParams(j())},w=function(a){return v()[a]},x=function(){return b.getParams("?"+i())},y=function(a){return x()[a]};h.getHash=j,h.getHash2=i,h.getParams=v,h.getParam=w,h.getSubParams=x,h.getSubParam=y,h.getQuery=t,h.getPath=u,h.setMainHash=p,h.setSubHash=q;var z=document.getElementsByTagName("base")[0];if(z)h.baseHref=z.href;else{var A=window.location,B=A.pathname;B=B.split("/"),B.pop(),B=B.join("/")||"/";var C,D=A.username?A.username+(A.password?":"+A.password:"")+"@":"";C=A.port&&("https"==A.protocol&&"443"!=A.port||"80"!=A.port)?":"+A.port:"",h.baseHref=A.protocol+"//"+D+A.host+C+B}var E=a.location.href;E=E.split("/"),E=E[0]+"//"+E[2],E=h.baseHref.substr(E.length),h.basePath=E;var F=a.location.href.substr(h.baseHref.length),G=F.indexOf("#");return G>-1&&(F=F.substr(0,G)),h.baseLocation=F,h}(window,jstack.url),jstack.dataBinder=function(){var a=function(){};a.prototype={dotGet:function(a,b,c){return a.split(".").reduce(function(a,b){return"object"==typeof a&&null!==a&&"undefined"!=typeof a[b]?a[b]:c},b)},dotSet:function(a,b,c,d){if("object"==typeof b)return a.split(".").reduce(function(a,b,e,f){return f.length!=e+1?("object"==typeof a[b]&&null!==a[b]||(a[b]={}),a[b]):(d&&a[b]&&(c=a[b]),void(d&&a[b]||(a[b]=c)))},b),c},dotDel:function(a,b,c){a.split(".").reduce(function(a,b,c,d){if("object"==typeof a)return d.length!=c+1?a[b]:void("undefined"!=typeof a[b]&&delete a[b])},b)},getKey:function(a){return a.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").replace(/\[\]/g,".")},getValue:function(a,b,c){var d=this,e=d.getControllerData(a),f=d.getScoped(a,b);return d.dotGet(f,e,c)},getValueEval:function(a,b,c){var d=this,e=d.getScopeValue(a);e=JSON.parse(JSON.stringify(e)),"undefined"==typeof b?b="undefined":null===b?b="null":""==b.trim()?b="undefined":(b=b.replace(/[\r\t\n]/g,""),b=b.replace(/(?:^|\b)(this)(?=\b|$)/g,"$this"));var f;f=function(b){b||(b=1),b+=1;for(var c=a,e=0;e<b;e++)c=d.getParentScope(c);var f=d.getScopeValue(c);return f};var g=d.getControllerData(a),h=d.getControllerObject(a),i=["$model, $scope, $controller, $this, $default, $parent"],j=[g,e,h,a,c,f],k=[],l=[],m=[];$(a).is("[j-for-id]")&&m.push(a),$(a).parents("[j-for-id]").each(function(){m.push(this)});var n=function(a,b){e[a]=b};$(m).each(function(){var a=$(this),b=a.closest("[j-for-list]");if(b.length){var c=b.attr("j-for-var"),e=b.attr("j-for-value"),f=a.attr("j-for-id");k.push(e);var g=c;g+=jstack.isIntKey(f)?"["+f+"]":"."+f,l.push(d.getValueEval(b,g));var h=b.attr("j-for-key"),i=b.attr("j-for-index");i&&n(i,a.index()+1),h&&n(h,f)}});for(var o=0,p=k.length;o<p;o++)i.push(k[o]);for(var o=0,p=l.length;o<p;o++)j.push(l[o]);i.push("with($scope){var $return = "+b+"; return typeof($return)=='undefined'?$default:$return;}");var q;try{var r=Function.apply(null,i);q=r.apply(null,j)}catch(s){jstack.config.debug&&console.warn(s.message,", expression: "+b,"element",a)}return q},getAttrValueEval:function(a,b,c){var d=this,e=$(a).attr(b);return d.getValueEval(a,e,c)},getAttrValue:function(a,b,c){var d=this,e=$(a).attr(b);return d.getValue(a,e,c)},getScopeValue:function(a){var b=this,c=$(a).closest("[j-scope]");return c.length?b.getAttrValue(c,"j-scope",{}):b.getControllerData(a)},getScope:function(a){return $(a).parents("[j-scope]").map(function(){return $(this).attr("j-scope")}).get().reverse().join(".")},getScopedInput:function(a){var b=this,c=$(a),d=c.attr("name"),e=b.getKey(d);if("."==e.substr(-1)&&c.is(":checkbox")){var f,g=b.getParentScope(a);g.find(':checkbox[name="'+d+'"]').each(function(b){if(this===a)return f=b,!1}),e+=f}return b.getScoped(a,e)},getScoped:function(a,b){if("."===b.substr(0,1))return b.substr(1);var c=this.getScope(a);return c&&(c+="."),c+=b},getters:{SELECT:function(a){return $(a).val()},INPUT:function(a){var b=$(a).prop("type");return"checkbox"==b||"radio"==b?$(a).prop("checked")?$(a).val():null:"file"==b?a.files:"submit"!=b?$(a).val():void 0},TEXTAREA:function(a){return $(a).val()}},defaultGetter:function(a){return $(a).html()},getInputVal:function(a){var b=a.tagName,c=this.getters[b]||this.defaultGetter;return c(a)},inputToModel:function(a,b,c){var d=$(a);if(!d.closest("[j-unscope]").length){var e=this,f=e.getControllerData(a),g=(d.attr("name"),function(g){var h=e.getScopedInput(a);g=e.dotSet(h,f,g,c),i!=g&&(g=i,d.populateInput(g,{preventValEvent:!0})),d.trigger(b,[g])}),h=e.getInputVal(a),i=e.filter(a,h);return"object"==typeof i&&null!==i&&"function"==typeof i.promise?void i.then(function(a){g(a)}):void g(i)}},validNodeEvent:function(a,b){if(a.nodeType==Node.TEXT_NODE&&a instanceof Text)return!1;if(b){var c=$(a);if(c.closest("[j-for]").length)return!1}return!0},loadMutations:function(a){var b=this;$.each(a,function(a,c){$.each(c.addedNodes,function(a,b){var c=$(b),d=c.add(c.find("*"));d.each(function(a,b){var c=$(b);if(!c.parent().closest("[j-for]").length&&$.contains(document.body,b)&&($.each(jstack.preloader,function(a,d){c.is(a)&&d.call(b)}),$.contains(document.body,b)))return b.nodeType==Node.TEXT_NODE&&b instanceof Text?void jstack.dataBinder.loaders.textMustache(b):void(c.data("j:load:state")||(c.data("j:load:state",1),setTimeout(function(){2!=c.data("j:load:state")&&(c.data("j:load:state",3),c.trigger("j:load"),c.data("j:load:state",3))},0)))})}),$.each(c.removedNodes,function(a,c){var d=$(c).add($(c).find("*"));d.each(function(a,c){b.validNodeEvent(c,!0)&&setTimeout(function(){$(c).trigger("j:unload")},0)})})})},eventListener:function(){var a=this,b=new MutationObserver(function(b){a.loadMutations(b)});b.observe(document,{subtree:!0,childList:!0,attribute:!1,characterData:!0}),$(document.body).on("input change",":input[name]",function(b){var c=a.getInputVal(this),d=$(this).data("jHandledValue");"undefined"!=typeof d&&c==d||($(this).data("jHandledValue",c),a.inputToModel(this,"j:input"))}),$(document.body).on("val",":input[name][j-val-event]",function(b){a.inputToModel(this,"j:input")}),$(document.body).on("j:update",":input[name]",function(b){$(this).data("j:populate:prevent",!0),a.inputToModel(this,"j:input"),$(this).one("j:input",function(){$(this).data("j:populate:prevent",!1)})})},filter:function(a,b){var c=this,d=c.getFilter(a);return"function"==typeof d&&(b=d(b)),b},getFilter:function(a){var b=this;a=$(a);var c=a.data("j-filter");if(!c){var d=a.attr("j-filter");if(d){var e=b.getValue(a,d);a.data("j-filter",e)}}return c},getControllerData:function(a){return this.getController(a).data("jModel")},getParentScope:function(a){var b=$(a).parent().closest("[j-scope]");return b.length||(b=this.getController(a)),b},getController:function(a){var b=$(a).closest("[j-controller]");return b.length||(b=$(document.body),b.attr("j-controller",""),b.data("jModel")||b.data("jModel",{})),b},getControllerObject:function(a){return this.getController(a).data("jController")},update:function(a){var b=this;$.each(jstack.preloader,function(b,c){$(b,a).each(function(){$.contains(document.body,this)&&c.call(this)})}),b.applyMustach(a)},applyMustach:function(a){a.find("*").contents().add(a.contents()).filter(function(){return this.nodeType==Node.TEXT_NODE&&this instanceof Text}).each(this.loaders.textMustache)},loaders:{jIf:function(){var a=$(this),b=!!jstack.dataBinder.getAttrValueEval(this,"j-if"),c=a.data("jIf");a.is(":empty")||(c=a.contents(),a.data("jIf",c)),a.data("jIfState")!==b&&(a.data("jIfState",b),b?a.is(":empty")&&(c.appendTo(a),a.trigger("j-if:true")):a.is(":empty")||(c.detach(),a.trigger("j-if:false")))},jSwitch:function(){var a=$(this),b=jstack.dataBinder.getAttrValueEval(this,"j-switch"),c=a.data("jSwitch");"undefined"==typeof c&&(c=a.find("[j-case],[j-case-default]"),a.data("jSwitch",c));var d=a.data("jSwitchState");if(d!==b){a.data("jSwitchState",b);var e=!1;c.filter("[j-case]").each(function(){var c=$(this),d=c.attr("j-case");d==b?(c.appendTo(a),c.trigger("j-switch:true"),e=!0):(c.detach(),c.trigger("j-switch:false"))}),c.filter("[j-case-default]").each(function(){var b=$(this);e?(b.detach(),b.trigger("j-switch:false")):(b.appendTo(a),b.trigger("j-switch:true"))})}},jFor:function(){var a=$(this),b=a.parent(),c=a.attr("j-for");c=c.trim();var d,e,f,g,h=new RegExp("(\\()(.*)(,)(.*)(,)(.*)(\\))(\\s+)(in)(\\s+)(.*)",["i"]),i=h.exec(c);if(null!=i)d=i[2].trim(),e=i[4].trim(),f=i[6],g=i[11].trim();else{var h=new RegExp("(\\()(.*)(,)(.*)(\\))(\\s+)(in)(\\s+)(.*)",["i"]),i=h.exec(c);if(null!=i)e=i[2].trim(),f=i[4],g=i[9].trim();else{var h=new RegExp("(.*)(\\s+)(in)(\\s+)(.*)",["i"]),i=h.exec(c);if(null==i)throw new Error("Malformed for clause: "+c);f=i[1],g=i[5].trim()}}b.attr("j-for-var",g),b.attr("j-for-value",f),e&&b.attr("j-for-key",e),"undefined"!=typeof d&&b.attr("j-for-index",d),b.attr("j-for-list","true"),b.data("jForTemplate",this),a.removeAttr("j-for"),a.data("parent",b),a.detach()},jForList:function(){var a=$(this);if(!a.attr("j-if")||jstack.dataBinder.getAttrValueEval(this,"j-if")){var b=a.data("jForTemplate"),c=a.attr("j-for-var"),d=jstack.dataBinder.getValueEval(this,c),e=[];$.each(d,function(c){var d=a.children('[j-for-id="'+c+'"]');d.length||(d=$(b).clone(),d.attr("j-for-id",c),d.appendTo(a)),e.push(c)}),a.children("[j-for-id]").each(function(){var a=$(this).attr("j-for-id");e.indexOf(a)===-1&&$(this).remove()})}},inputWithName:function(){var a=$(this);if(!a.closest("[j-unscope]").length){var b=jstack.dataBinder.getInputVal(this),c=jstack.dataBinder.getKey(a.attr("name")),d=jstack.dataBinder.getValue(this,c,b);a.data("j:populate:prevent")||(a.populateInput(d,{preventValEvent:!0}),a.trigger("j:val",[d]))}},jVar:function(){var a=jstack.dataBinder.getValueEval(this,$(this).data("j-var"));$(this).html(a)},jHref:function(){var a=$(this),b=a.data("j-href");b||(b=a.attr("j-href"),a.data("j-href",b));var c=jstack.dataBinder.textParser(b),d="string"==typeof c?jstack.dataBinder.getValueEval(this,c):b;a.attr("href",jstack.route.baseLocation+"#"+d)},jVarAttr:function(){var a=$(this),b=a.attrStartsWith("j-var-");$.each(b,function(b,c){var d=jstack.dataBinder.getValueEval(a,c);a.attr(b.substr(6),d)})},jModelAttr:function(){var a=$(this),b=a.attrStartsWith("j-model-");$.each(b,function(b,c){var d=jstack.dataBinder.textParser(c),e="string"==typeof d?jstack.dataBinder.getValueEval(a,d):c;a.attr(b.substr(8),e)})},jDataAttr:function(){var a=$(this),b=a.attrStartsWith("j-data-");$.each(b,function(b,c){var d=a.data(b);d||(d=c,a.data(b,d));var e=jstack.dataBinder.textParser(d);if("string"==typeof e){var f=jstack.dataBinder.getValueEval(a,e);a.attr(b,f)}})},jShrotcutModelAttr:function(){var a=$(this),b=a.attrStartsWith("j-shortcut-model-");$.each(b,function(b,c){var d=jstack.dataBinder.getValueEval(a,c),e=b.substr(17);d?a.attr(e,e):a.removeAttr(e)})},textMustache:function(){if(this.textContent){var a=jstack.dataBinder.textParser(this.textContent.toString());if("string"==typeof a){var b=a.replace(/'/g,"\\'").replace(/"/g,"'"),c=$("<span/>").data("j-var",b);$(this).replaceWith(c)}}}},textParser:function(a){var b=/\{\{((?:.|\n)+?)\}\}/g;if(b.test(a)){for(var c,d,e=[],f=b.lastIndex=0;c=b.exec(a);){d=c.index,d>f&&e.push(JSON.stringify(a.slice(f,d)));var g=c[1].trim();e.push("("+g+")"),f=d+c[0].length}return f<a.length&&e.push(JSON.stringify(a.slice(f))),e.join("+")}}};var b=new a;return b.eventListener(),b}(),$.on("reset","form[j-scope]",function(){$(this).populateReset()}),function(a,b){var c=function(a,b){var c=a[b];return c!==Object[b]&&c!==Object.__proto__[b]&&c!==Array[b]&&c!==Array.__proto__[b]},d=function(b){for(var c=[],d=a.param(b).split("&"),e=0;e<d.length;e++){var f=d[e].split("="),g=null!==f[1]?decodeURIComponent(f[1]):"";c.push([decodeURIComponent(f[0]),g])}return c},e=function(b,c,d,f){d||(d="");for(var g in b)if(b.hasOwnProperty(g)){var h=d+g,i=b[g];if(i instanceof FileList){if(1==i.length)c[h]=i[0];else{c[h]=[];for(var j=0;j<i.length;j++)c[h].push(i[j])}delete b[g]}else i instanceof a?b[g]=i.jsonml():i instanceof HTMLCollection||i instanceof HTMLElement?b[g]=a(i).jsonml():"object"==typeof i&&e(i,c,h+"_",f+1)}},f=function(a){for(var b in a)c(a,b)&&("undefined"==typeof a[b]||null===a[b]?a[b]="":"object"==typeof a[b]&&(a[b]=f(a[b])));return a};b.ajax=function(){var b,c={};if(2==arguments.length?(b=arguments[1]||{},b.url=arguments[0]):b=arguments[0],b.data&&e(b.data,c),!a.isEmptyObject(c)){for(var g,h=new FormData,i=d(b.data),j=0;j<i.length;j++)h.append(i[j][0],i[j][1]);for(var k in c)if(c.hasOwnProperty(k)){var l=c[k];if(l instanceof Array)for(var j=0;j<l.length;j++)"undefined"!=typeof l[j]&&(h.append(k+"[]",l[j]),g=!0);else"undefined"!=typeof l&&(h.append(k,l),g=!0)}g&&(b.type="POST",b.processData=!1,b.contentType=!1,b.data=h)}return b.data=f(b.data),a.ajax(b)},b.post=function(a,c,d,e){return b.ajax({type:"POST",url:a,data:c,success:d,dataType:e})}}(jQuery,jstack),jstack.mvc=function(a){"string"==typeof arguments[0]&&(a={view:arguments[0],controller:"string"==typeof arguments[1]?arguments[1]:arguments[0]}),a.controller||(a.controller=a.view),a.target||(a.target=jstack.config.defaultTarget);var b=$(a.target),c=a.controller,d=a.view.split("/");d.pop(),d=d.join("/")+"/",d=jstack.config.templatesPath+d;var e,f=jstack.config.templatesPath+a.view+".jml",g=jstack.config.controllersPath+a.controller,h=$.Deferred(),i=$.Deferred();jstack.controllers[a.controller]?h.resolve():$js.onExists(g,h.resolve,h.resolve),jstack.template.get(f).then(function(f){var g=a.view+"#"+a.controller;jstack.template.compile($("<tmpl>"+f+"</tmpl>"),g,d).then(function(a){e=function(d){var e=a(d);b.data("jModel",d),b.attr("j-controller",c),Boolean(b.attr("j-view-append"))?b.append(e):b.html(e)},i.resolve()})});var j=$.Deferred();return $.when(h,i).then(function(){var c=jstack.controller(a.controller,b);c.ready.then(function(){if("object"==$.type(a.data)&&$.extend(c.data,a.data),c.render=function(a){a&&a!==c.data&&$.extend(c.data,a),e(c.data),c.domReady&&setTimeout(function(){c.domReady(),j.resolve(b,c)})},c.setData){var d=c.setDataCall();if(d===!1)return;"object"==$.type(d)&&d!==c.data&&$.extend(c.data,d)}c.render()})}),j},jstack.viewReady=function(a){if("string"==typeof arguments[0]){var b='[j-view="'+arguments[0]+'"]';a="object"==typeof arguments[1]?$(arguments[1]).find(b):$(b)}a=$(a);var c=a.data("jViewReady");return c||(c=$.Deferred(),a.data("jViewReady",c)),c},$.on("j:load","[j-view]:not([j-view-loaded])",function(){var a=$(this);a.attr("j-view-loaded",!0);var b,c=a.attr("j-view");b=a[0].hasAttribute("j-controller")?a.attr("j-controller"):c;var d=a.data("jModel")||{};if(a.hasAttr("j-view-inherit")){var e=a.parent().closest("[j-controller]");if(e.length){var f=a.attr("j-view-inherit"),g=e.data("jModel")||{};f?d[f]=g:d=$.extend({},g,d)}}var h=jstack.viewReady(this),i=jstack.mvc({view:c,controller:b,target:this,data:d});i.then(function(){setTimeout(function(){h.resolve()},0)})}),function(){jstack.app=function(a,b){b||(b=a.attr("j-app")),jstack.config.templatesPath+=b+"/",jstack.config.controllersPath+=b+"/",jstack.route("*",function(a){return a=jstack.url.getPath(a),jstack.mvc(a)})};var a=$("[j-app]");a.length&&jstack.app(a)}();